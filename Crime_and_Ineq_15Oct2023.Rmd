---
title: "Is U.S. Economic Inequality Associated with Crime Rates?"
author: "Steven R. Morrison"
date: "2023-10-15"
output:
  pdf_document: default
  word_document: default
  html_document: default

---

#Introduction

Crime in the United States is a perennial topic of political conversation, whose rate is often used--and abused--for political purposes. The U.S. economy, and especially its effects on individual Americans, is a similar topic of conversation. In both cases, misunderstandings (or, for some politicians, misstatements) abound. What actually *is* the crime rate in the U.S. today, and how is it trending compared to past years? Is it high or low? For which populations? What forces move the crime rate up or down? How healthy is our economy today *really*, and how does it compare to past years? Is is true that "a rising tide" raises all boats, so that GDP and other similar measures are indicative of the economy, or has our economy split, roughly, into the haves, the middle class, and the have-nots? These questions persist because defining the crime rate and understanding the health of the U.S. economy are not straightforward questions. Understanding the *causes* of the crime rate and the *effects* of a healthy or sick economy are one step beyond, and are that much more difficult to address.

This article is a foray into this complex world. It asks whether there is an association between rising economic inequality and the crime rate in the U.S., and if there is, what that association is. Its hypothesis is that increasing economic inequality is positively associated with a higher crime rate. It does not make a causal claim.

In order to test this hypothesis, this article first takes two measures of economic inequality, with data from the Federal Reserve Economic Data (FRED): the Gini coefficient and net wealth between the bottom half of Americans, the 50th-90th percentile, the 90th-99th percentile, and the top 1%. It establishes trends for each of these measures since 1979. These two indices will provide the article's measure of economic inequality.

This article then analyzes data on U.S. crime rates from the National Crime Victimization Survey (NCVS). Determining U.S. crime rates is substantially more difficult than determining economic inequality. This article will not conclude that there is a single "crime rate" for the U.S. Rather, it will explore the various types of crime, the types of offenders and victims, the locations of crime, and other variables in an attempt to map out various crime *rates*.

This article then establishes correlations between its measures of economic inequality and crime rates. It concludes that, based on the data analyzed, there is no discernible association between economic inequality and crime rates. This analysis does have its limitations, so further research is necessary to determine whether there is in fact an association.

#Mainstream economic markers

Most mainstream economic markers suggest that the U.S. is doing quite well. Gross Domestic Product Per Capita has been growing steadily, doubling since 1979:

```{r}
#Load packages
library(readxl)
library(ggplot2)
library(tidyverse)
library(lubridate)
library(readr)
library(dplyr)
library(changepoint)
library(sarbcurrent)
library(ggthemes)
```


```{r}
#Import FRED datasets, create objects from them
FRED_datasets_to_edit <- read_excel("Datasets/FRED datasets to edit.xlsx")

gdppercent <- FRED_datasets_to_edit$'Real GDP percent change'

gdppercap <- FRED_datasets_to_edit$`Real gross domestic product per capita: billions of chained 2012 dollars`

prodchange <- FRED_datasets_to_edit$`Nonfarm Business Sector: Labor Productivity (Output per Hour) for All Workers: percent change from quarter one year ago`

savingrate <- FRED_datasets_to_edit$`Personal saving rate: percent`

parttimeppl <- FRED_datasets_to_edit$`Part time work: thousands of persons`

hourlycomp <- FRED_datasets_to_edit$`Nonfarm Business Sector: Real Hourly Compensation for All Workers: percent change`

realearnings <- FRED_datasets_to_edit$`Employed full time: Median usual weekly real earnings: Wage and salary workers: 16 years and over: 1982-1984 CPI adjusted dollars`

dispincome <- FRED_datasets_to_edit$`Real disposable personal income: percent change`

#A line plot of real GDP per capita, from 1-1-1979
ggplot(FRED_datasets_to_edit, aes(Date, gdppercap)) +
    theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  labs(title = "Real GDP per capita",
       subtitle = "1979-2022",
       x = "Year",
       y = "GDP",
       color = "Region")

summary(gdppercap)
```

---

With the exception of the COVID-19 period of time, the change in Real GDP per capita has remained steadily positive, with an average annual increase of 0.4008:

```{r}
#A line plot of percent change in real GDP per capita, from 1-1-1979
ggplot(FRED_datasets_to_edit, aes(Date, gdppercent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("Change in GDP") +
  ggtitle("Change in Real GDP per capita")

summary(gdppercent)
```

---

Other numbers suggest a strong U.S. economy. The most widely used unemployment rate has remained similarly consistent since 1953, at around 6% (Fig. 2).^[FRED, “Unemployment Rate,” available at https://fred.stlouisfed.org/series/UNRATE.] The consumer price index (CPI) has shown stability with some isolated exceptions,^[FRED, “Sticky Price Consumer Index less Food and Energy,” available at https://fred.stlouisfed.org/series/CORESTICKM159SFRBATL; FRED, “Consumer Price Index: All Items for the United States,” available at https://fred.stlouisfed.org/series/USACPIALLMINMEI.] and personal income has risen gradually, at a rate favorable in comparison to the CPI (Fig. 3).^[FRED, “Real Disposable Personal Income,” available at https://fred.stlouisfed.org/series/DSPIC96.] Real disposable income has been rising more than Real GDP, 596% as to income from Q1 1959 to Q4 2022 compared to 546% as to GDP (Fig. 4).^[Id.; FRED, “Real Gross Domestic Product,” available at https://fred.stlouisfed.org/series/GDPC1.] In 2021, the World Economic Forum named the U.S. the third most innovative country in the world,^[Katherina Buchholz, World Economic Forum, “The world’s most innovative countries,” available at https://www.weforum.org/agenda/2021/09/worlds-most-innovative-countries-innovation/.] and its GNP was ranked fifth in the world per capita.^[OECD, “Gross national income,” available at https://data.oecd.org/natincome/gross-national-income.htm.] Productivity has continued to increase for the past 70 years (Fig. 5),^[FRED, “Total Factor Productivity at Constant National Prices for United States,” available at https://fred.stlouisfed.org/series/RTFPNAUSA632NRUG.] making the U.S. arguably the wealthiest country by far in the world, with GDP in 2021 at 23.3 trillion, second to China at 17.7 trillion,^[The World Bank, “GDP (current US$),” available at https://data.worldbank.org/indicator/NY.GDP.MKTP.CD?end=2021&most_recent_value_desc=true&start=1960&view=chart.] which has four times the population of the U.S.^[United States Census Bureau, “China,” available at https://www.census.gov/popclock/world/ch.]

Indeed, a glance at the five key data that the Federal Open Markets Committee (FOMC) highlights in its projection materials--Real GDP Growth, Unemployment Rate, PCE Inflation, Core PCE Inflation, and the Federal Funds Rate^[FRED, "Key Economic Indicators," available at https://stlouisfed.shinyapps.io/macro-snapshot/#home]--all suggest a healthy economy. All of these data are described in this article except the Federal Funds Rate. That rate is up since early 2022, but is still quite reasonable as a long-view historical matter.^[FRED, "Federal Funds Effective Rate," available at https://fred.stlouisfed.org/series/DFF]. And in any event, the increasing rate is in response to a market that is probably too hot.

#Questioning American prosperity: economic inequality

If the U.S. economy, writ large, is doing well over the past decade, why turn our attention to economic inequality? We do so first as an attempt to illuminate the reasons for a number of troubling economic, social, and political indicators. 

There are, indeed, many indicators that point toward troubling inequality. The GINI Index for the U.S. has been increasing since 1980 (Fig. 6).^[FRED, “GINI Index for the United States,” available at https://fred.stlouisfed.org/series/SIPOVGINIUSA.] Median weekly real earnings (a better indicator of inequality than mean or overall earnings) for those who are employed full time have mostly flatlined since the late 1970s (Fig. 7).^[FRED, “Employed full time: Median usual weekly real earnings: Wage and salary workers: 16 years and over,” available at https://fred.stlouisfed.org/series/LES1252881600Q.] The difference between real disposable personal income and median weekly real earnings is probably explicable by growing income inequality, which is hollowing out the middle class. With data going back to 1984, the top quintiles have, over time, taken home ever-increasing shares of income compared to the quintiles below them (Fig. 8).^[FRED, “Income After Taxes: Income After Taxes by Quintiles of Income Before Taxes: Lowest 20 Percent (1st to 20th Percentile),” available at https://fred.stlouisfed.org/series/CXUINCAFTTXLB0102M; FRED, “Income After Taxes: Income After Taxes by Quintiles of Income Before Taxes: Second 20 Percent (21st to 40th Percentile),” available at https://fred.stlouisfed.org/series/CXUINCAFTTXLB0103M; FRED, “Income After Taxes: Income After Taxes by Quintiles of Income Before Taxes: Third 20 Percent (41st to 60th Percentile),” available at https://fred.stlouisfed.org/series/CXUINCAFTTXLB0104M; FRED, “Income After Taxes: Income After Taxes by Quintiles of Income Before Taxes: Fourth 20 Percent (61st to 80th Percentile),” available at https://fred.stlouisfed.org/series/CXUINCAFTTXLB0105M; FRED, “Income After Taxes: Income After Taxes by Quintiles of Income Before Taxes: Highest 20 Percent (81st to 100th Percentile),” available at https://fred.stlouisfed.org/series/CXUINCAFTTXLB0106M.] Over the same time, the share of net worth has increased for the top 1%, remained stable for the 90th to 99th percentiles, and decreased for everyone below that (Fig. 9).^[FRED, “Share of Total Net Worth Held by the Bottom 50% (1st to 50th Wealth Percentiles),” available at https://fred.stlouisfed.org/series/WFRBSB50215; FRED, “Share of Total Net Worth Held by the 50th to 90th Wealth Percentiles,” available at https://fred.stlouisfed.org/series/WFRBSN40188; FRED, “Share of Total Net Worth Held by the 90th to 99th Wealth Percentiles,” available at https://fred.stlouisfed.org/series/WFRBSN09161; FRED, “Share of Total Net Worth Held by the Top 1% (99th to 100th Wealth Percentiles),” available at https://fred.stlouisfed.org/series/WFRBST01134.]

Furthermore, more and more Americans have been forced into part-time work (Fig. 10).^[FRED, “Employed, Usually Work Part Time,” available at https://fred.stlouisfed.org/series/LNS12600000] The increase in labor productivity has been substantially outpacing that of real hourly compensation (Fig. 11).^[U.S. Bureau of Labor, “Labor Productivity and Real Hourly Compensation, Nonfarm Business Sector, 1973-2022,” available at https://www.bls.gov/productivity/graphics/2022/graphic-4.htm.] Benefits have been pulled back: in 1957, nearly 66% of households had employment-based health insurance.^[Melissa Thomasson, “Why Do Employers Provide Health Care in the First Place?” HARVARD BUSINESS REVIEW, March 15, 2019, available at https://hbr.org/2019/03/why-do-employers-provide-health-care-in-the-first-place.] By 2020, 54.4% had such insurance.^[Katherine Keisler-Starkey & Lisa N. Bunch, U.S. Census Bureau, “Health Insurance Coverage in the United States: 2020,” Sept. 14, 2021, available at https://www.census.gov/library/publications/2021/demo/p60-274.html.] Retirement plans are less effective today as well: between 1907 and the mid-1970s, the personal savings rate was consistent, at around 13%. Since the mid-1970s, it has gradually, with some exceptional periods, declined to around 4% in 2022.^[FRED, “Personal Saving Rate,” available at https://fred.stlouisfed.org/series/PSAVERT.] With the exception of the COVID period and three brief moments, the last time the personal savings rate was consistently above 10% was in 1985.^[Id.] 

Furthermore, the labor force participation rate has been falling since 2000, from 67% to 62.5% today.^[FRED, “Labor Force Participation Rate,” available at https://fred.stlouisfed.org/series/CIVPART.] For people 25-54 years of age, labor force participation has fallen from 84.6% in 1999 to 83.1% in February 2023.^[FRED, “Labor Force Participation Rate—25-54 years,” available at https://fred.stlouisfed.org/series/LNS11300060.] This is a small decrease, but it’s a decrease among people in their prime working years. This decline among men is much more dramatic.^[FRED, “TITLE," available at https://fred.stlouisfed.org/series/LRAC25MAUSM156S.] And people 55 years of age and older have seen an increase in labor force participation from 29.2% in 1993 to just over 40% on the eve of COVID-19 (it’s 38.4% in Feb. 2023).^[FRED, “Labor Force Participation Rate—55 Yrs. & over,” available at https://fred.stlouisfed.org/series/LNS11324230.] Why are older people still working? They might be healthier, but that contradicts the evidence regarding American physical health and health care, noted below. It is more likely that these older Americans are struggling financially.

---

Let's consider some other markers, starting with the percentage change of real hourly compensation for all
workers:
```{r}
#A line graph of real hourly compensation change for all workers
ggplot(FRED_datasets_to_edit, aes(Date, hourlycomp)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("Compensation") +
  ggtitle("real hourly compensation change for all workers")
```

This has increased only an average of 1.027%, which is 0.74% less than the increase in productivity.
```{r}
summary(hourlycomp)
```

---

Consider also the median weekly real earnings for people 16 years of age and above:
```{r}
#A line plot of median weekly real earnings for people 16 years and above
ggplot(FRED_datasets_to_edit, aes(Date, realearnings)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("Earnings") +
  ggtitle("Median weekly real earnings, people 16 years +")
``` 

This increase looks pretty good, going from $309 to $393:
```{r}
summary(realearnings)
```

---

But observe that while median weekly real earnings have increased approximately 27%, GDP has doubled over the same time. And consider the *change* in real disposable personal income:
```{r}
#A line plot of real disposable person income
ggplot(FRED_datasets_to_edit, aes(Date, dispincome)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("Income") +
  ggtitle("Change in real disposable personal income")
```

```{r}
summary(dispincome)
```

---

Finally, the personal savings rate has been falling, and is now at a troublingly low level. It has gradually drifted downward from 11.13% in 1979 to 4.8% in 2023:
```{r}
#A line plot of personal saving rates
ggplot(FRED_datasets_to_edit, aes(Date, savingrate)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("Saving rate") +
  ggtitle("Personal saving rate") +
  geom_point() +
  geom_smooth(method = 'lm')
```

---

There is *something* wrong with the U.S. economy. Economists who study the issue point to economic inequality as the primary force, as do typical Americans.

Statistics and polls demonstrate what economists like Joseph Stiglitz^[Joseph E. Stiglitz, speech at the BI Norwegian Business School, 2018, available at YouTube, “How Did China Succeed? | Joseph E. Stiglitz | BI Norwegian Business School”, https://www.youtube.com/watch?v=Iaw4n9IZDdc.] and Thomas Piketty^[Thomas Piketty, “About Capital in the Twenty-First Century,” AMERICAN ECONOMIC REVIEW: PAPERS & PROCEEDINGS 2015, 105(5); Thomas Piketty, The Economics of Inequality (1997).] have been saying for years: that beginning in 1979-1980, inequality in the U.S. ended its decades-long downward slope and began to increase, as it has been doing ever since.

Should anything be done? Early modern economists Adam Smith and David Ricardo were concerned with inequality.^[Pim de Zwart, “The Global History of Inequality,” IRSH 64 (2019), pp. 310.] Simon Kuznets in 1955 asked whether “the political framework . . . [could] withstand the strain which further widening of income inequality is likely to generate.” Such strain could, according to Kuznets, “necessitate drastic changes in social and political organization.”  Kuznets was ultimately optimistic, positing his famous curve that would ultimately turn developed societies away from rising inequality and toward equality.^[de Zwart, supra note 41, at p. 315.] By 1997, however, Thomas Piketty could convincingly declare the Kuznets curve to be “definitely dead."^[Thomas Piketty, The Economics of Inequality (1997).]

Despite the Pikettys, Stiglitzes, and Kuznetses of the economic world, “[f]or much of the twentieth century . . . distribution of wealth had been of relatively minor importance in economics.”^[de Zwart, supra note 41, at p. 310.] By the 1980s, however, inequality became an increasingly common subject across academic fields. John Rawls was most responsible for initiating the modern discussion of inequality from the point of view of political philosophy. His conception of inequality was singular: we should be concerned about inequality, he argued, of which there is only one sort. Then Ronald Dworkin suggested two types of inequality—one type for which people are responsible, and another type for which they are not responsible.^[John E. Roemer, “On Several Approaches to Equality of Opportunity,” ECONOMICS AND PHILOSOPHY, 28 (2012) 165-200, p. 165-66.] Economists would universally adopt and refine this dual conception of inequality. They would come to agree that individuals can be unequal based on circumstances that are not their fault, and based on efforts or decisions for which they are responsible. Economists furthermore generally agree that some redistributive efforts are appropriate for the former but not the latter. They somewhat disagree about the appropriate extent of redistributions, and they really disagree about what comprises a circumstance for which one is not responsible and an effort/decision for which one is responsible. This last disagreement comprises virtually all of the current literature on economic inequality.

This dual conception of inequality gained prominence in the literature only in around 2011,^[Gustavo A. Marrero & Juan G. Rodriguez, “Inequality of opportunity and growth,” JOURNAL OF DEVELOPMENT ECONOMICS, 104 (2013) 107-122, p. 107.] but economists have coalesced around it: inequality for which one is not responsible is one’s inequality of “type” (gender, race, IQ, etc.),^[Roemer, supra note 46, at 168.] “circumstances,”^[Marc Fleurbaey & Vito Peragine, “Ex Ante Versus Ex Post Equality of Opportunity,” ECONOMICA (2013) 80, 118-130, p. 118.] or “opportunity,”^[Gustavo Marrero & Juan G. Rodriguez, “Inequality of Opportunity and Growth,” Instituto de Estudio Fiscales and Departamento de Economia Aplicada, Universidad Rey Juan Carlos, Unpublished Manuscript, 2009.] and inequality for which one is responsible is one’s inequality of effort.^[Roemer, supra note 46, at p. 168.] Although the difference is important (people generally agree that redistribution for inequality of circumstance is appropriate and economically beneficial, and that redistribution for effort is neither appropriate nor economically beneficial), even as late as 2011 scholars weren’t clearly distinguishing between the two.^[Marrero & Rodriguez, supra note 47, at 108.] This failure to distinguish is as understandable as it is frustrating: one’s effort and choices are guided, determined, and limited—at least to some extent—by one’s upbringing, parents, childhood neighborhood, and so forth. It is hard to distinguish between the two forms of inequality because they are inextricably intertwined. 

The difficulty now is twofold: first, how can we distinguish the two different types of inequality, and thus correctly set redistributive policies, and second, while it is generally accepted that redistribution based on inequality of circumstance would have economic benefits to the country, there is debate about whether redistribution based on inequality of effort would also have benefits. Many believe that the answer to these two questions is vital to the future of the United States as an economy,^[Robert J. Gordon, “The Demise of U.S. Economic Growth: Restatement, Rebuttal, and Reflections,” NBER Working Paper No. 19895, February 2014, p. 1; Joseph Stiglitz, “Inequality Is Holding Back the Recovery,” NEW YORK TIMES OPINIONATOR, Jan. 19, 2013 (Inequality “is associated with more frequent and more severe boom-and-bust cycles that make our economy more volatile and vulnerable”).] society,^[American Psychological Association, “Work, Stress, and Health & Socioeconomic Status,” available at https://www.apa.org/pi/ses/resources/publications/work-stress-health; U.S. Office of Disease Prevention and Health Promotion, “Social Determinants of Health,” available at https://health.gov/healthypeople/priority-areas/social-determinants-health; World Health Organization, “Social determinants of health,” available at https://www.who.int/health-topics/social-determinants-of-health#tab=tab_1.] and democracy.^[Katherine Bradbury & Robert K. Triest, “Inequality of Opportunity and Aggregate Economic Performance,” RSF: THE RUSSELL SAGE FOUNDATION JOURNAL OF THE SOCIAL SCIENCES, May 2016, Vol. 2, No. 2, p. 183 (“inequality has risen so high that the rich have been able to take over political institutions and shift policy-making in their favor to such a degree that it contributes to greater inequality”); de Zwart, supra note 41, at p. 321 (“As a result of increasing inequality, the relative size of the middle class is declining across the Western world, which is problematic as the middle classes are generally seen as the most important supporters of democracy.”).]

#Two inequality indices

In this section, I establish two indices of economic inequality: the Gini coefficient and the wealth gap. 

---

The most popular indicator of inequality is the Gini coefficient, which has been steadily increasing since 1980:
```{r}
#Import Gini dataset
gini <- read_csv("Datasets/gini_coefficient.csv")

gini$year <- year(mdy(gini$DATE))

#A chart of the Gini coefficient
ggplot(gini, aes(x = year)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Gini coefficient, 1974-2020") +
  geom_line(aes(y = SIPOVGINIUSA, group = 1)) +
  xlab("Year") +
  ylab("Gini coefficient")
```

---

Net wealth by group, many economists believe, is another important indicator of economic inequality. Wealth (rather than income) offers someone stability over time, the ability to weather unforeseen financial events, plan for a comfortable retirement, respond to unanticipated medical needs, and thereby live a life of reduced stress and increased well-being. Thomas Piketty encapsulated economists' concern with wealth by stating the at "*r* > *g*", where *r* is the return on capital, and *g* is the growth of the economy. In the absence of relevant regulations, capital, argues Piketty, will grow faster than the economy, meaning that the rich will, over time, get richer, and the inequality gap larger. And the wealth gap in the U.S. is increasingly wide:

```{r}
#Import net worth dataset
FRED_net_worth <- read_excel("Datasets/FRED_net_worth.xlsx")

Top1Net_Worth_1992_2021 <- read_excel("Datasets/Top1Net Worth 1992-2021.xls", 
    col_names = FALSE)

networth_top1 <- FRED_net_worth$`Share of Total Net Worth Held by the Top 1% (99th to 100th Wealth Percentiles): percentage`

networth_90_99 <- FRED_net_worth$`Share of Total Net Worth Held by the 90th to 99th Wealth Percentiles: percentage`

networth_50_90 <- FRED_net_worth$`Share of Total Net Worth Held by the 50th to 90th Wealth Percentiles: percentage`

networth_low50 <- FRED_net_worth$`Share of Total Net Worth Held by the Bottom 50% (1st to 50th Wealth Percentiles): percentage`

#A chart of groups' net worth over time
ggplot(FRED_net_worth, aes(x = Date)) +
  theme_fivethirtyeight() +
  theme(axis.title = element_text()) +
  ggtitle("Net worth by group", subtitle = "1989-2022") +
  geom_line(aes(y = networth_low50), color = "black") +
  geom_line(aes(y = networth_50_90), color = "blue") +
  geom_line(aes(y = networth_90_99), color = "green") +
  geom_line(aes(y = networth_top1), color = "red") +
  xlab("Year") +
  ylab("Percentage of U.S. Dollars")

summary(networth_low50)
```

---

Let's examine the correlation in net worth between these four groups. The most obvious trend one might notice from the above graph is that the share of net worth among the top 1% (the red line) appears to be an almost mirror image of the share of net worth among the 50th-90th percentilers (the blue line). This impression is correct, as the negative correlation in terms of net wealth between these two groups is -0.9151248. You might also have noticed that the net worth of the 90th-99th percentilers (green line) and the net worth of the lower 50% of Americans fluctuates over time but ultimately doesn't change much. While that is true, the negative correlation between these two groups' net worth is -0.8803127. There are smaller negative correlations between the net worth of the top 1% and the lower 50% (-0.6684097), and the 90th-99th percentilers and the 50th-90th percentilers (-0.7522137). But the takeaway is clear: when the net worth of the top 10% increases, the net worth of the bottom 90% decreases very predictably.

Shifts in net worth, furthermore, are solely between these two groups (top 10% and bottom 90%). The correlation in net worth between the top 1% and the 90th-99th percentilers is positive, at 0.4631535, as is the correlation between the 50th-90th percentilers and the lowest 50%, at 0.8011561. As the top 1% do better, the 90th-90th percentilers also generally do better, and as the 50th-90th percentilers do worse, the lowest 50% very predictably also does worse.

```{r}
#Correlation tests between net worth groups
cor.test(networth_top1, networth_50_90)
cor.test(networth_top1, networth_90_99)
cor.test(networth_top1, networth_low50)
cor.test(networth_90_99, networth_low50)
cor.test(networth_90_99, networth_50_90)
cor.test(networth_50_90, networth_low50)
```

---

As an absolute, the numbers on net worth are similarly concerning:

The least wealthy Americans (the bottom half, shown above in black) held 3.8% of wealth in 1989, which fell to 2.5% in 2022.
The Americans whose wealth fell in the 50-90th percentile held 36.3% of wealth in 1989, which fell to 28.5% in 2022.
The Americans whose wealth fell in the 90-99th percentile held 37.4% of wealth in 1989, which stayed relatively flat, falling to 37.0% in 2022.
And the wealthiest 1 percent of Americans held 23.6% of the country's wealth in 1989. That group increased in share to 31.9% in 2022.

*Between 1989 and 2022, 99% of Americans became worse off, while the top 1% increased its share of the American wealth pie by just over a third.*

---

The poverty rate, shown below, suggests two things. First, more Americans have not generally drifted into poverty. Second, the poverty rate, despite the country's wealth, continues to persist at a substantial level. Over the period 1989-2021, the poverty rate ranged from 11.3% to 15.9%, with an average of 13.49%.

This is to be expected, given the data above: it is not the very poor who are doing increasingly poorly to the benefit of the very wealthy--to be stark, the very poor have never had much to lose to begin with. Rather, it is the middle class, the 50th to 90th percentile of Americans in terms of wealth that is being decimated. Where are these people going? A few are certainly joining the ranks of the very wealthy, a few are falling down into the lower 50% of Americans. Others, I suspect, are cutting back on spending and living on credit, and their decrease in wealth has not yet become apparent in society. As savings and
credit run out (see infra data on credit cards), I suspect we will see further declines in middle America's standard of living.
```{r}
#Import dataset on poverty
FRED_poverty <- read_excel("Datasets/FRED_poverty.xlsx")

povertyrate <- FRED_poverty$`Estimated Percent of People of All Ages in Poverty for United States: percent`

#A chart of poverty, 1989 to 2021
ggplot(FRED_poverty, aes(x = Date)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Poverty rate, 1989-2021") +
  geom_line(aes(y = povertyrate)) +
  xlab("Year") +
  ylab("Poverty rate")

summary(povertyrate)
```

Because the poorer half of the country has remained consistently poor, and the 90th-99th percentile hasn't changed its wealth much, let's focus on the wealth change in the top 1% and the 50th-90th percentile. Specifically, let's measure the difference in wealth between these two populations:
```{r}
#Creating a graph comparing top 1% net worth to 50th-90th percentile
diff1to50_90 <- networth_top1 - networth_50_90

vectordiff <- c(diff1to50_90)
vectordate <- c(FRED_net_worth$Date)

diffnetworth <- data.frame(vectordate, vectordiff)

ggplot(diffnetworth) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line(mapping = aes(x = vectordate, y = vectordiff)) +
  ggtitle("Net worth difference, top 1% to 50th-90th percentile") +
  xlab("Year") +
  ylab("Difference in net worth")
```

---

As is expected, the Gini coefficient and the difference in net worth between the top 1% and the 50th-90th percentile appear to be highly positively correlated. And to put this is change in inequality another way, in 1989 the 50th-90th percentile's wealth exceeded that of the top 1% by 12.7% of total U.S. wealth; in 2014 the top 1% had the same amount of wealth as the 50th-90th percentile; and in Q1 2022 the top 1%'s wealth exceeded that of the 50th-90th percentile by 3.4% of total U.S. wealth. In Q1 2022, U.S. wealth totaled $137,810,737 million.^[FRED, "All Sectors; U.S. Wealth, Level," available at https://fred.stlouisfed.org/series/BOGZ1FL892090005Q]. With a population at that time of 332,662,461,^[U.S. Census, "U.S. and World Population Clock," available at https://www.census.gov/popclock/], 133,064,984 people were in the 50th-90th percentile, and 3,326,624 people were in the top 1%. Between 1989 and 2022, $22,187,529 million (in 2022 dollars) shifted from the 50th-90th percentile to the top 1%. This means that every 50th-90th percentiler lost $166,742, while every top 1%er gained $6,669,683. 

This bears repeating: at the individual level, increasing inequality has resulted in 40% of individual Americans having $166,742 of wealth shifted away from them to 1% of Americans, who now individually possess an additional $6,669,683. In recent decades, the median net worth of families has not exceeded $149,000 in 2019 dollars, and has usually been much lower.^[Bd. of Governors of the Federal Reserve System, "Survey of Consumer Finances (SCF)," available at https://www.federalreserve.gov/econres/scf/dataviz/scf/chart/#series:Net_Worth;demographic:all;population:1;units:median;range:1989,2019]. One might ask how these middle Americans are getting by. The answer may be credit: since 2003, Americans' total debt balance has gone from around $6 trillion to around $13 trillion.^[Federal Reserve Bank of New York, "Quarterly Report on Household Debt and Credit," May 2023, p. 4, available at https://www.newyorkfed.org/microeconomics/hhdc.html]. The debt balances of people ages 30-59 (who should be most likely to comprise the 50th-90th percentile population) have approximately doubled, and the debt balances of people over 60 years of age have more than doubled.^[Id. at 20] 

---

(AUTHOR'S NOTE: HERE I PROVIDE DATA ON AFTER-TAX INCOME. BECAUSE IT IS A LESS RELIABLE INDICATOR OF ECONOMIC INEQUALITY THAN GINI OR NET WORTH, I DO NOT CONSIDER IT FURTHER) After-tax income is another relevant indicator of economic inequality, alongside the Gini coefficient and net wealth. Let's take a look at the income after taxes by quintiles of income before taxes from Jan. 1, 1984, to Jan. 1, 2021. This is a more limited date range than the above data because FRED only provides this shorter date range. And income after taxes is used rather than income before taxes because the United States tax code functions in part to reduce certain forms of inequality (though to what extent and how well are topics of debate).

```{r}
#Import dataset on after-tax income quintiles
Income_quintiles <- read_excel("Datasets/Income_quintiles.xlsx")

income81_100 <- Income_quintiles$`Income After Taxes: Income After Taxes by Quintiles of Income Before Taxes: Highest 20 Percent (81st to 100th Percentile): U.S. dollars`

income61_80 <- Income_quintiles$`Income After Taxes: Income After Taxes by Quintiles of Income Before Taxes: Fourth 20 Percent (61st to 80th Percentile): U.S. dollars`

income41_60 <- Income_quintiles$`Income After Taxes: Income After Taxes by Quintiles of Income Before Taxes: Third 20 Percent (41st to 60th Percentile): U.S. dollars`

income21_40 <- Income_quintiles$`Income After Taxes: Income After Taxes by Quintiles of Income Before Taxes: Second 20 Percent (21st to 40th Percentile): U.S. dollars`

income0_20 <- Income_quintiles$`Income After Taxes: Income After Taxes by Quintiles of Income Before Taxes: Lowest 20 Percent (1st to 20th Percentile): U.S. dollars`

#A chart of quintile incomes over time
ggplot(Income_quintiles, aes(x = Date)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("After-tax income by quintiles, 1984-2021") +
  geom_line(aes(y = income0_20), color = "black") +
  geom_line(aes(y = income21_40), color = "blue") +
  geom_line(aes(y = income41_60), color = "green") +
  geom_line(aes(y = income61_80), color = "yellow") +
  geom_line(aes(y = income81_100), color = "red") +
  xlab("Year") +
  ylab("U.S. Dollars")
```

---

Incomes by quintile, therefore, have increased from 1984 to 2021 as follows:
0-20%: from $3,137 to $15,909, a 5.071x increase.
21-40%: from $9,751 to $37,504, a 3.846x increase.
41-60%: from $17,068 to $60,957, a 3.571x increase.
60-80%: from $26,247 to $93,674, a 3.569x increase.
81-100%: from $49,871 to $184,804, a 3.706x increase.

As one can see, the middle class (41-80%) has seen the lowest increase in income. The lowest two quintiles have seen the largest increase, followed by the highest quintile. One could conclude that the poorest Americans and the wealthiest have done well--or at least relatively well, compared to the middle class. Of course, for the poor there is very little to lose, so any increase in income will appear to be relatively large. And for the rich--the above data show that they have gotten richer, either through accumulating a larger share of wealth or, as here, capturing relatively larger incomes.

#Other indicators that the U.S. economy is covertly struggling: physical health and health care

U.S. life expectancy is 79.5 years, which trails at least 34 countries, including Cuba, Costa Rica, and Chile, and has been declining absolutely even before COVID-19.^[UNDP, “Human Development Indices and Indicators, 2018 Statistical Update.” p. 22, available at https://hdr.undp.org/content/statistical-update-2018.] The U.S. mortality ratio is 14—countries like Norway, Australia, Germany, Sweden, Japan, France, Spain, Italy, the UK, and Canada all have ratios under 10.^[Id. at 38.] Infant and under-five mortality is 5.6% and 6.5%, respectively, with peer countries at the 2-4% range.^[Id. at 50.] Two percent of U.S. children are malnourished, whereas this rate in peer countries is almost always too small to count.^[Id.] In 2020, 50% of Americans were concerned that a major health event in their household could lead to bankruptcy, and 25% of Americans must borrow money for a $500 medical bill.^[Dan Witters, “50% in U.S. Fear Bankruptcy Due to Major Health Event,” GALLUP, Sept. 1, 2020, available at https://news.gallup.com/poll/317948/fear-bankruptcy-due-major-health-event.aspx.] In the same year, 32% of Americans reported recently either being unable to pay for medical care or medicine or lacking access to quality healthcare.^[Dan Witters & Nicole Willcoxon, “Stress Prominent Among U.S. Adults Struggling to Pay for Care,” GALLUP, Dec. 5, 2022, available at https://news.gallup.com/opinion/gallup/406178/stress-prominent-among-adults-struggling-pay-care.aspx.] As for the overall poverty rate, the U.S. is in the company of Estonia, Turkey, Korea, and Lithuania, but the U.S. poverty rate among people 65 years of age and older is similar to that of Costa Rica, Australia, Lithuania, and Bulgaria.^[OECD, “Poverty rate,” available at https://data.oecd.org/inequality/poverty-rate.htm.] In 2019, the only OECD country that had less population coverage for core health care was Mexico.^[OECD, “Health at a Glance 2021: OECD Indicators,” p. 127, available at https://www.oecd-ilibrary.org/social-issues-migration-health/health-at-a-glance-2021_ae3016b9-en.]    

#Other indicators that the U.S. economy is covertly struggling: educational attainment

Let's look first at the rate of four-year graduation from public high schools from 2010 to 2021. The Department of Education hosts data on this subject from 2010-2021.^[Department of Education, "Data Library," available at https://eddataexpress.ed.gov/download/data-library?field_year_target_id=All&field_population_value=All+Students&field_data_topic_target_id=54&field_reporting_level_target_id=26&field_program_target_id=All&field_file_spec_target_id=All&field_data_group_id_target_id=All&combine=]

```{r}
#Import datasets on graduation rates
gradrate10_18 <- read_csv("Datasets/gradrate10_18.csv", show_col_types = FALSE)[ ,c('School Year', 'State', 'Value', 'Subgroup')]

gradrate18_19 <- read_csv("Datasets/gradrate18_19.csv", show_col_types = FALSE)[ ,c('School Year', 'State', 'Value', 'Subgroup')]

gradrate20_21 <- read_csv("Datasets/gradrate20_21.csv", show_col_types = FALSE)[ ,c('School Year', 'State', 'Value', 'Subgroup')]

gradrate19_20 <- read_csv("Datasets/gradrate19_20.csv", show_col_types = FALSE)[ ,c('School Year', 'State', 'Value', 'Subgroup')]

gradrate <- rbind(gradrate10_18, gradrate18_19, gradrate19_20, gradrate20_21)

allstudentsUS <- filter(gradrate, Subgroup == "All Students", State == "UNITED STATES")

#The graduation rate for all students in the U.S. has consistently increased from 79% in 2010-2011 to 86.5% in 2020-2021

asianstudents <- filter(gradrate, Subgroup == "Asian", State == "UNITED STATES")

#There is no data on the graduation rate of Asian students

blackstudents <- filter(gradrate, Subgroup == "Black or African American", State == "UNITED STATES")

#The graduation rate for all black students in the U.S. has consistently increased from 67% in 2010-2011 to 79.6% in 2020-2021

econdisabledstudents <- filter(gradrate, Subgroup == "Economically Disadvantaged", State == "UNITED STATES")

#The graduation rate for all economically disadvantaged students in the U.S. has consistently increased from 70% in 2010-2011 to 81.3% in 2020-2021

hispaniclatinostudents <- filter(gradrate, Subgroup == "Hispanic/Latino", State == "UNITED STATES")

#The graduation rate for hispanic/latino students has consistenly increased from 71% to 82.5%

whitestudents <- filter(gradrate, Subgroup == "White or Caucasian (not Hispanic)", State == "UNITED STATES")

#The graduation rate for white students has consistently increased from 84% to 90.2%

englishstudents <- filter(gradrate, Subgroup == "English Learner", State == "UNITED STATES")

#The graduation rate for english learner students has consistently increased from 57% to 71.3%
```

---

From the period 2010-2021, for which the DOE reports data, high school graduation rates in the United States consistently increased for all examined subgroups, including all students, black/African American students, economically disadvantaged students, Hispanic/Latino students, white students, and English learner students (there was no data on Asian students). This data set has limitations and requires further examination: what would the data prior to 2010 tell us? what if the data were disaggregated into, say, states? what if the increased graduation rates of each subgroup were compared to the increase in inequality in each subgroup? In short, the data I present here on graduation rates is only a vary small, very inadequate glimpse into the American education system.

#Other indicators that the U.S. economy is covertly struggling: consumer debt loads

```{r}
#Import datasets on consumer debt
consumer_debt_stats <- read_excel("Datasets/consumer_debt_stats.xlsx")

ccdate <- consumer_debt_stats$ccdate

ccbalances <- consumer_debt_stats$`Large Bank Consumer Credit Card Balances: Total Balances, Billions of U.S. Dollars, Not Seasonally Adjusted`

ccoriginations <- consumer_debt_stats$`Large Bank Consumer Credit Card Originations: New Originations, Billions of U.S. Dollars, Not Seasonally Adjusted`

ccnewaccounts <- consumer_debt_stats$`Large Bank Consumer Credit Card Originations: Number of New Accounts, Millions, Not Seasonally Adjusted`

ccfullbalpaid <- consumer_debt_stats$`Large Bank Consumer Credit Card Balances: Share of Accounts Making Full Balance Payment, Percent, Not Seasonally Adjusted`

cc30dayslate <- consumer_debt_stats$`Large Bank Consumer Credit Card Balances: 30 or More Days Past Due Rates: Accounts Based, Percent, Not Seasonally Adjusted`

ccminpaid <- consumer_debt_stats$`Large Bank Consumer Credit Card Balances: Share of Accounts Making the Minimum Payment, Percent, Not Seasonally Adjusted`

cc90dayslate <- consumer_debt_stats$`Large Bank Consumer Credit Card Balances: 90 or More Days Past Due Rates: Accounts Based, Percent, Not Seasonally Adjusted`
```

I established above that since 1989, $166,742 for each individual in the 50th-90th percentile has been converted to $6,669,683 for each individual in the top 1% through the mechanism of increasingly inequality. I also noted that in recent decades the median net worth of families has not exceeded $149,000. How is this possible? Call it the blood from a stone conundrum. One way that 50th-90th percentilers have been making up the difference is by carrying increasing amounts of debt. Here is a graph of credit card balances in the billions of dollars since around 2012:
```{r}
#A graph of credit card balances
ggplot(consumer_debt_stats, aes(x = ccdate)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Credit Card Balances, Billions of Dollars") +
  geom_line(aes(y = ccbalances)) +
  xlab("Date") +
  ylab("Balances")
```

---

Credit card originations are up, approximately doubling since 2012:

```{r}
#A graph of credit card originations
ggplot(consumer_debt_stats, aes(x = ccdate)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Credit Card Originations, millions") +
  geom_line(aes(y = ccoriginations)) +
  xlab("Date") +
  ylab("Credit card originations, millions")
```

---

So, more people are possessing more credit cards, and are carrying larger balances. But are they falling behind in their payments? Let's take a look:
```{r}
#A graph of credit card payments made or not made
ggplot(consumer_debt_stats, aes(x = ccdate)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Credit Card Payments Made or Not Made") +
  geom_line(aes(y = ccfullbalpaid), color = "black") +
  geom_line(aes(y = ccminpaid), color = "yellow") +
  geom_line(aes(y = cc30dayslate), color = "green") +
  geom_line(aes(y = cc90dayslate), color = "red") +
  xlab("Date") +
  ylab("Share of accounts making a particular payment")
```

---

Credit card originations don't seem very correlated to rates of full payments made or late payments, and is weakly correlated to rate of minimum payments made:
```{r}
#Correlation tests regarding credit card data
cor.test(ccoriginations, ccfullbalpaid)
cor.test(ccoriginations, ccminpaid)
cor.test(ccoriginations, cc30dayslate)
cor.test(ccoriginations, cc90dayslate)
```

---

Similarly, credit card balances seem weakly correlated to rates of full payments made, somewhat correlated to minimum payments made, and not very correlated to late payments made.
```{r}
#Correlation tests regarding credit card data
cor.test(ccbalances, ccfullbalpaid)
cor.test(ccbalances, ccminpaid)
cor.test(ccbalances, cc30dayslate)
cor.test(ccbalances, cc90dayslate)
```

---

Surprisingly, the increase in credit card balances and credit card originations does not seem to have much positive association with the performance of debtors in terms of payments made and types of payments made. The data on this is, therefore, interesting and calls for further inquiry. As shown below, most credit card holders pay their balances off fully (the black line), and have been doing so more and more since 2012. A substantial, but unchanging, portion of card holders pay off the minimum (the yellow line). This is concerning because these accounts accrue interest, which is generally high, and that, other things held equal, result in a continual shift of wealth from the card holders to the banks, and implicitly from the relatively poor Americans to the relatively wealthy Americans. That said, the number of delinquencies, either 30-day (the green line), or the 90-day (the red line), have also remained stable, suggesting that the minimum balance payers have continued to pay the minimum. Either these minimum payers are not really falling behind, and could pay their bills off if they wanted (some people prefer to carry a balance), or they are racking up increasing amounts of credit card debt, which will, at some point, have some negative effect on the economy.

---

As a sidenote, these graphs on consumer credit card debt suggest that the COVID-19 pandemic was an economic boon to the middle class: people became less indebted, increasingly paid their credit card bills in full and on time, and decreasingly opened new lines of credit card debt. Let's look at the various classes of credit card holders more granularly. First, the number of card holders who paid their bill in full responded to COVID by increasingly paying off in full:

```{r}
#A plot regarding credit card data
plot(ccfullbalpaid ~ ccdate)
```

---

The number of delinquencies was also down in the COVID period, including those who were 30 days past due:
```{r}
#A plot regarding credit card data
plot(cc30dayslate ~ ccdate)
```

---

Just as much as those who were 90 days past due:
```{r}
#A plot regarding credit card data
plot(cc90dayslate ~ ccdate)
```

---

And just as people were more likely to pay their balances off in full and on time, the share of balances on which the minimum was paid decreased:

```{r}
#A plot regarding credit card data
plot(ccminpaid ~ ccdate)
```

---

While much of inequality is problematic from the standpoint of economics, society, and politics, and is not the fault of the decreasingly wealthy middle class, another story emerges: if people are thrifty, as they apparently were during COVID-19, they can, at least partially, escape the worst of the debt traps that the modern American society has set for them. It bears emphasis: many economists believe that inequality remains an intractable, macroeconomic problem--during the COVID-19 pandemic, which began in 2020, and afterwards, the wealth of the top 1% increased at the same rate that the wealth of the 50th-90th percentilers decreased. Individual thriftiness may stave off the worst of the effects of economic inequality, but it may only do so for a time. If inequality increases, the squeeze that the 50th-90th percentilers feel may turn into a crush. And there is evidence that the thriftiness of the COVID-era hasn't persisted: Americans are, by and large, returning to their pre-COVID spendthrift ways.

---

#Measuring crime rates

In 2019, sociologist Karen Heimer observed that inequality, defined broadly, undergirded much of what criminologists study, but that the reality of inequality's effect on crime is sometimes taken for granted because it is omnipresent and seems almost invisible.^[Karen Heimer, "Inequalities and crime," Criminology 2019:377-394, p. 378] She acknowledged the economic truth that "economic inequality and extreme disadvantage have increased in recent years in the United States."^[Id.] She points to the economics literature that establishes the increasing inequality since 1979 that this article presents, above.^[Id.] She also points to the scholarship on economic inequality and crime, which "has a long history":

>Empirical researchers have uncovered associations between crime rates and various indicators of economic health, including unemployment statistics, measures of economic discrimination, and the Index of Consumer Sentiment (e.g., Arvanites & Defina, 2006; Cantor & Land, 1985; Cook & Zarkin, 1985; Messner, 1989; Rosenfeld & Fornango, 2007). There has been vigorous debate about the best measurement tools, correct levels of analysis and statistical specifications, most appropriate criminal behaviors to examine, and variation in the association across subgroups (e.g., Baumer, Horney, Felson, & Lauritsen, 2003; Britt, 1997; Bushway, Cook, & Phillips, 2012; Greenberg, 2001; Paternoster & Bushway, 2001; Phillips & Land, 2012; Rosenfeld & Fornango, 2007). At the end of the day, these scholars have suggested that crime and economic conditions are linked at the macro-level, theoretically and empirically, and this is a central fact that must underlie our understanding of crime.^[Id. at 381.]

What can be said of the link between inequality and crime today? And what do we mean by "inequality"? Heimer's definition is broad, and includes "economic, race, ethnic, and gender inequalities."^[Id. at 389.] Her prescription going forward is to "expand research on the ways in which different forms of inequalities coalesce to affect crime, violence, and victimization.^[Id.] This section of this article begins that project by linking crime rates to the increasing wealth gap between the top 1% and the 50th-90th percentilers. What can we glean from this comparison?

Having established two measures of economic inequality, let's turn now to U.S. crime rates, which I draw from the NCVS. I use NCVS data since 1992 because prior to that year, the statistics collected by the Bureau of Justice Statistics, which collects the NCVS data, were different. It is difficult, therefore, to compare data prior to 1992 with data 1992 and after. In any event, a period of nearly thirty years will suffice to illustrate the U.S. crime rate as currently relevant. As an aside, in 2025 the NCVS will see another major overhaul, so the time is appropriate to review this data over its past 30 years.

Why use the NCVS? First, the NCVS is "the nation's primary source of information on criminal victimization."^[Bureau of Justice Statistics, "National Crime Victimiziation Survey," available at https://bjs.ojp.gov/programs/ncvs.] Second, the NVCS is one of two measures of the crime rate in the U.S., the other being the Uniform Crime Reports (UCR).^[Federal Bureau of Investigation, "The Nation's Two Crime Measures," available athttps://ucr.fbi.gov/crime-in-the-u.s/2018/crime-in-the-u.s.-2018/topic-pages/nations-two-crime-measures.] The UCR, however, does not attempt to track crime that is not reported to police.^[Id.] The UCR may have advantages over the NCVS, so this article's preference for the NCVS should not be interpreted as a wholesale rejection of the UCR.

#Data collection

I began my data collection by navigating to website of the National Archive of Criminal Justice Data, sponsored by the University of Michigan, which maintains NCVS data.^[NACJD, "National Crime Victimization Survey (NCVS) Series, available at https://www.icpsr.umich.edu/web/NACJD/series/95.] 

I downloaded each of the annual NCVS datasets from 1992 to 2021 (the most recent year with available data at the time of this research) as delimited files. I used a revised version for the 2016 dataset (no other year had revised data). In addition, when the NACJD began to offer data in R format in 2011, I continued to use delimited data to maintain a consistent format. I then imported these datasets into R with the following code (note that I changed the delimiter from comma to whitespace)^[Also to note: By 2017, the above datasets had depleted R's default allocation of memory. To manually expand the available memory, I saved "R_MAX_VSIZE = 100Gb" into my R project terminal. This resolved the problem and I was able to import all of the 1992-2021 data. Importation, however, remained slow, and when I attempted to aggregate each of the four types of datasets into four larger time series datasets, my computer could not handle the process. I had to install more RAM, from 8 GB to 40 GB. Use of a different computer resolved my available memory problem, so researchers who wish to replicate my work may not encounter the same technological issues.]:

```{r}
# 1992 data
X22929_0001_Data <- read.delim("Datasets/1992_ICPSR_22929/DS0001/22929-0001-Data.tsv", sep = "\t")

X22929_0002_Data <- read.delim("Datasets/1992_ICPSR_22929/DS0002/22929-0002-Data.tsv", sep = "\t")

X22929_0003_Data <- read.delim("Datasets/1992_ICPSR_22929/DS0003/22929-0003-Data.tsv", sep = "\t")

X22929_0004_Data <- read.delim("Datasets/1992_ICPSR_22929/DS0004/22929-0004-Data.tsv", sep = "\t")

# 1993 data
X22928_0001_Data <- read.delim("Datasets/1993_ICPSR_22928/DS0001/22928-0001-Data.tsv", sep = "\t")

X22928_0002_Data <- read.delim("Datasets/1993_ICPSR_22928/DS0002/22928-0002-Data.tsv", sep = "\t")

X22928_0003_Data <- read.delim("Datasets/1993_ICPSR_22928/DS0003/22928-0003-Data.tsv", sep = "\t")

X22928_0004_Data <- read.delim("Datasets/1993_ICPSR_22928/DS0004/22928-0004-Data.tsv", sep = "\t")

# 1994 data
X22927_0001_Data <- read.delim("Datasets/1994_ICPSR_22927/DS0001/22927-0001-Data.tsv", sep = "\t")

X22927_0002_Data <- read.delim("Datasets/1994_ICPSR_22927/DS0002/22927-0002-Data.tsv", sep = "\t")

X22927_0003_Data <- read.delim("Datasets/1994_ICPSR_22927/DS0003/22927-0003-Data.tsv", sep = "\t")

X22927_0004_Data <- read.delim("Datasets/1994_ICPSR_22927/DS0004/22927-0004-Data.tsv", sep = "\t")

# 1995 data
X22926_0001_Data <- read.delim("Datasets/1995_ICPSR_22926/DS0001/22926-0001-Data.tsv", sep = "\t")

X22926_0002_Data <- read.delim("Datasets/1995_ICPSR_22926/DS0002/22926-0002-Data.tsv", sep = "\t")

X22926_0003_Data <- read.delim("Datasets/1995_ICPSR_22926/DS0003/22926-0003-Data.tsv", sep = "\t")

X22926_0004_Data <- read.delim("Datasets/1995_ICPSR_22926/DS0004/22926-0004-Data.tsv", sep = "\t")

# 1996 data
X22925_0001_Data <- read.delim("Datasets/1996_ICPSR_22925/DS0001/22925-0001-Data.tsv", sep = "\t")

X22925_0002_Data <- read.delim("Datasets/1996_ICPSR_22925/DS0002/22925-0002-Data.tsv", sep = "\t")

X22925_0003_Data <- read.delim("Datasets/1996_ICPSR_22925/DS0003/22925-0003-Data.tsv", sep = "\t")

X22925_0004_Data <- read.delim("Datasets/1996_ICPSR_22925/DS0004/22925-0004-Data.tsv", sep = "\t")

# 1997 data
X22924_0001_Data <- read.delim("Datasets/1997_ICPSR_22924/DS0001/22924-0001-Data.tsv", sep = "\t")

X22924_0002_Data <- read.delim("Datasets/1997_ICPSR_22924/DS0002/22924-0002-Data.tsv", sep = "\t")

X22924_0003_Data <- read.delim("Datasets/1997_ICPSR_22924/DS0003/22924-0003-Data.tsv", sep = "\t")

X22924_0004_Data <- read.delim("Datasets/1997_ICPSR_22924/DS0004/22924-0004-Data.tsv", sep = "\t")

# 1998 data
X22923_0001_Data <- read.delim("Datasets/1998_ICPSR_22923/DS0001/22923-0001-Data.tsv", sep = "\t")

X22923_0002_Data <- read.delim("Datasets/1998_ICPSR_22923/DS0002/22923-0002-Data.tsv", sep = "\t")

X22923_0003_Data <- read.delim("Datasets/1998_ICPSR_22923/DS0003/22923-0003-Data.tsv", sep = "\t")

X22923_0004_Data <- read.delim("Datasets/1998_ICPSR_22923/DS0004/22923-0004-Data.tsv", sep = "\t")

# 1999 data
X22922_0001_Data <- read.delim("Datasets/1999_ICPSR_22922/DS0001/22922-0001-Data.tsv", sep = "\t")

X22922_0002_Data <- read.delim("Datasets/1999_ICPSR_22922/DS0002/22922-0002-Data.tsv", sep = "\t")

X22922_0003_Data <- read.delim("Datasets/1999_ICPSR_22922/DS0003/22922-0003-Data.tsv", sep = "\t")

X22922_0004_Data <- read.delim("Datasets/1999_ICPSR_22922/DS0004/22922-0004-Data.tsv", sep = "\t")

# 2000 data
X22921_0001_Data <- read.delim("Datasets/2000_ICPSR_22921/DS0001/22921-0001-Data.tsv", sep = "\t")

X22921_0002_Data <- read.delim("Datasets/2000_ICPSR_22921/DS0002/22921-0002-Data.tsv", sep = "\t")

X22921_0003_Data <- read.delim("Datasets/2000_ICPSR_22921/DS0003/22921-0003-Data.tsv", sep = "\t")

X22921_0004_Data <- read.delim("Datasets/2000_ICPSR_22921/DS0004/22921-0004-Data.tsv", sep = "\t")

# 2001 data
X22920_0001_Data <- read.delim("Datasets/2001_ICPSR_22920/DS0001/22920-0001-Data.tsv", sep = "\t")

X22920_0002_Data <- read.delim("Datasets/2001_ICPSR_22920/DS0002/22920-0002-Data.tsv", sep = "\t")

X22920_0003_Data <- read.delim("Datasets/2001_ICPSR_22920/DS0003/22920-0003-Data.tsv", sep = "\t")

X22920_0004_Data <- read.delim("Datasets/2001_ICPSR_22920/DS0004/22920-0004-Data.tsv", sep = "\t")

# 2002 data
X22902_0001_Data <- read.delim("Datasets/2002_ICPSR_22902/DS0001/22902-0001-Data.tsv", sep = "\t")

X22902_0002_Data <- read.delim("Datasets/2002_ICPSR_22902/DS0002/22902-0002-Data.tsv", sep = "\t")

X22902_0003_Data <- read.delim("Datasets/2002_ICPSR_22902/DS0003/22902-0003-Data.tsv", sep = "\t")

X22902_0004_Data <- read.delim("Datasets/2002_ICPSR_22902/DS0004/22902-0004-Data.tsv", sep = "\t")

# 2003 data
X22901_0001_Data <- read.delim("Datasets/2003_ICPSR_22901/DS0001/22901-0001-Data.tsv", sep = "\t")

X22901_0002_Data <- read.delim("Datasets/2003_ICPSR_22901/DS0002/22901-0002-Data.tsv", sep = "\t")

X22901_0003_Data <- read.delim("Datasets/2003_ICPSR_22901/DS0003/22901-0003-Data.tsv", sep = "\t")

X22901_0004_Data <- read.delim("Datasets/2003_ICPSR_22901/DS0004/22901-0004-Data.tsv", sep = "\t")

# 2004 data
X22900_0001_Data <- read.delim("Datasets/2004_ICPSR_22900/DS0001/22900-0001-Data.tsv", sep = "\t")

X22900_0002_Data <- read.delim("Datasets/2004_ICPSR_22900/DS0002/22900-0002-Data.tsv", sep = "\t")

X22900_0003_Data <- read.delim("Datasets/2004_ICPSR_22900/DS0003/22900-0003-Data.tsv", sep = "\t")

X22900_0004_Data <- read.delim("Datasets/2004_ICPSR_22900/DS0004/22900-0004-Data.tsv", sep = "\t")

# 2005 data
X22746_0001_Data <- read.delim("Datasets/2005_ICPSR_22746/DS0001/22746-0001-Data.tsv", sep = "\t")

X22746_0002_Data <- read.delim("Datasets/2005_ICPSR_22746/DS0002/22746-0002-Data.tsv", sep = "\t")

X22746_0003_Data <- read.delim("Datasets/2005_ICPSR_22746/DS0003/22746-0003-Data.tsv", sep = "\t")

X22746_0004_Data <- read.delim("Datasets/2005_ICPSR_22746/DS0004/22746-0004-Data.tsv", sep = "\t")

# 2006 data
X22560_0001_Data <- read.delim("Datasets/2006_ICPSR_22560/DS0001/22560-0001-Data.tsv", sep = "\t")

X22560_0002_Data <- read.delim("Datasets/2006_ICPSR_22560/DS0002/22560-0002-Data.tsv", sep = "\t")

X22560_0003_Data <- read.delim("Datasets/2006_ICPSR_22560/DS0003/22560-0003-Data.tsv", sep = "\t")

X22560_0004_Data <- read.delim("Datasets/2006_ICPSR_22560/DS0004/22560-0004-Data.tsv", sep = "\t")

# 2007 data
X25141_0001_Data <- read.delim("Datasets/2007_ICPSR_25141/DS0001/25141-0001-Data.tsv", sep = "\t")

X25141_0002_Data <- read.delim("Datasets/2007_ICPSR_25141/DS0002/25141-0002-Data.tsv", sep = "\t")

X25141_0003_Data <- read.delim("Datasets/2007_ICPSR_25141/DS0003/25141-0003-Data.tsv", sep = "\t")

X25141_0004_Data <- read.delim("Datasets/2007_ICPSR_25141/DS0004/25141-0004-Data.tsv", sep = "\t")

# 2008 data
X26382_0001_Data <- read.delim("Datasets/2008_ICPSR_26382/DS0001/26382-0001-Data.tsv", sep = "\t")

X26382_0002_Data <- read.delim("Datasets/2008_ICPSR_26382/DS0002/26382-0002-Data.tsv", sep = "\t")

X26382_0003_Data <- read.delim("Datasets/2008_ICPSR_26382/DS0003/26382-0003-Data.tsv", sep = "\t")

X26382_0004_Data <- read.delim("Datasets/2008_ICPSR_26382/DS0004/26382-0004-Data.tsv", sep = "\t")

# 2009 data
X28543_0001_Data <- read.delim("Datasets/2009_ICPSR_28543/DS0001/28543-0001-Data.tsv", sep = "\t")

X28543_0002_Data <- read.delim("Datasets/2009_ICPSR_28543/DS0002/28543-0002-Data.tsv", sep = "\t")

X28543_0003_Data <- read.delim("Datasets/2009_ICPSR_28543/DS0003/28543-0003-Data.tsv", sep = "\t")

X28543_0004_Data <- read.delim("Datasets/2009_ICPSR_28543/DS0004/28543-0004-Data.tsv", sep = "\t")

# 2010 data
X31202_0001_Data <- read.delim("Datasets/2010_ICPSR_31202/DS0001/31202-0001-Data.tsv", sep = "\t")

X31202_0002_Data <- read.delim("Datasets/2010_ICPSR_31202/DS0002/31202-0002-Data.tsv", sep = "\t")

X31202_0003_Data <- read.delim("Datasets/2010_ICPSR_31202/DS0003/31202-0003-Data.tsv", sep = "\t")

X31202_0004_Data <- read.delim("Datasets/2010_ICPSR_31202/DS0004/31202-0004-Data.tsv", sep = "\t")

# 2011 data
X34061_0001_Data <- read.delim("Datasets/2011_ICPSR_34061/DS0001/34061-0001-Data.tsv", sep = "\t")

X34061_0002_Data <- read.delim("Datasets/2011_ICPSR_34061/DS0002/34061-0002-Data.tsv", sep = "\t")

X34061_0003_Data <- read.delim("Datasets/2011_ICPSR_34061/DS0003/34061-0003-Data.tsv", sep = "\t")

X34061_0004_Data <- read.delim("Datasets/2011_ICPSR_34061/DS0004/34061-0004-Data.tsv", sep = "\t")

# 2012 data
X34650_0001_Data <- read.delim("Datasets/2012_ICPSR_34650/DS0001/34650-0001-Data.tsv", sep = "\t")

X34650_0002_Data <- read.delim("Datasets/2012_ICPSR_34650/DS0002/34650-0002-Data.tsv", sep = "\t")

X34650_0003_Data <- read.delim("Datasets/2012_ICPSR_34650/DS0003/34650-0003-Data.tsv", sep = "\t")

X34650_0004_Data <- read.delim("Datasets/2012_ICPSR_34650/DS0004/34650-0004-Data.tsv", sep = "\t")

# 2013 data
X35164_0001_Data <- read.delim("Datasets/2013_ICPSR_35164/DS0001/35164-0001-Data.tsv", sep = "\t")

X35164_0002_Data <- read.delim("Datasets/2013_ICPSR_35164/DS0002/35164-0002-Data.tsv", sep = "\t")

X35164_0003_Data <- read.delim("Datasets/2013_ICPSR_35164/DS0003/35164-0003-Data.tsv", sep = "\t")

X35164_0004_Data <- read.delim("Datasets/2013_ICPSR_35164/DS0004/35164-0004-Data.tsv", sep = "\t")

# 2014 data
X36142_0001_Data <- read.delim("Datasets/2014_ICPSR_36142/DS0001/36142-0001-Data.tsv", sep = "\t")

X36142_0002_Data <- read.delim("Datasets/2014_ICPSR_36142/DS0002/36142-0002-Data.tsv", sep = "\t")

X36142_0003_Data <- read.delim("Datasets/2014_ICPSR_36142/DS0003/36142-0003-Data.tsv", sep = "\t")

X36142_0004_Data <- read.delim("Datasets/2014_ICPSR_36142/DS0004/36142-0004-Data.tsv", sep = "\t")

# 2015 data
X36448_0001_Data <- read.delim("Datasets/2015_ICPSR_36448/DS0001/36448-0001-Data.tsv", sep = "\t")

X36448_0002_Data <- read.delim("Datasets/2015_ICPSR_36448/DS0002/36448-0002-Data.tsv", sep = "\t")

X36448_0003_Data <- read.delim("Datasets/2015_ICPSR_36448/DS0003/36448-0003-Data.tsv", sep = "\t")

X36448_0004_Data <- read.delim("Datasets/2015_ICPSR_36448/DS0004/36448-0004-Data.tsv", sep = "\t")

# 2016 data
X37296_0001_Data <- read.delim("Datasets/2016_ICPSR_37296/DS0001/37296-0001-Data.tsv", sep = "\t")

X37296_0002_Data <- read.delim("Datasets/2016_ICPSR_37296/DS0002/37296-0002-Data.tsv", sep = "\t")

X37296_0003_Data <- read.delim("Datasets/2016_ICPSR_37296/DS0003/37296-0003-Data.tsv", sep = "\t")

X37296_0004_Data <- read.delim("Datasets/2016_ICPSR_37296/DS0004/37296-0004-Data.tsv", sep = "\t")

# 2017 data
X36981_0001_Data <- read.delim("Datasets/2017_ICPSR_36981/DS0001/36981-0001-Data.tsv", sep = "\t")

X36981_0002_Data <- read.delim("Datasets/2017_ICPSR_36981/DS0002/36981-0002-Data.tsv", sep = "\t")

X36981_0003_Data <- read.delim("Datasets/2017_ICPSR_36981/DS0003/36981-0003-Data.tsv", sep = "\t")

X36981_0004_Data <- read.delim("Datasets/2017_ICPSR_36981/DS0004/36981-0004-Data.tsv", sep = "\t")

# 2018 data
X37297_0001_Data <- read.delim("Datasets/2018_ICPSR_37297/DS0001/37297-0001-Data.tsv", sep = "\t")

X37297_0002_Data <- read.delim("Datasets/2018_ICPSR_37297/DS0002/37297-0002-Data.tsv", sep = "\t")

X37297_0003_Data <- read.delim("Datasets/2018_ICPSR_37297/DS0003/37297-0003-Data.tsv", sep = "\t")

X37297_0004_Data <- read.delim("Datasets/2018_ICPSR_37297/DS0004/37297-0004-Data.tsv", sep = "\t")

# 2019 data
X37645_0001_Data <- read.delim("Datasets/2019_ICPSR_37645/DS0001/37645-0001-Data.tsv", sep = "\t")

X37645_0002_Data <- read.delim("Datasets/2019_ICPSR_37645/DS0002/37645-0002-Data.tsv", sep = "\t")

X37645_0003_Data <- read.delim("Datasets/2019_ICPSR_37645/DS0003/37645-0003-Data.tsv", sep = "\t")

X37645_0004_Data <- read.delim("Datasets/2019_ICPSR_37645/DS0004/37645-0004-Data.tsv", sep = "\t")

# 2020 data
X38090_0001_Data <- read.delim("Datasets/2020_ICPSR_38090/DS0001/38090-0001-Data.tsv", sep = "\t")

X38090_0002_Data <- read.delim("Datasets/2020_ICPSR_38090/DS0002/38090-0002-Data.tsv", sep = "\t")

X38090_0003_Data <- read.delim("Datasets/2020_ICPSR_38090/DS0003/38090-0003-Data.tsv", sep = "\t")

X38090_0004_Data <- read.delim("Datasets/2020_ICPSR_38090/DS0004/38090-0004-Data.tsv", sep = "\t")

# 2021 data
X38429_0001_Data <- read.delim("Datasets/2021_ICPSR_38429/DS0001/38429-0001-Data.tsv", sep = "\t")

X38429_0002_Data <- read.delim("Datasets/2021_ICPSR_38429/DS0002/38429-0002-Data.tsv", sep = "\t")

X38429_0003_Data <- read.delim("Datasets/2021_ICPSR_38429/DS0003/38429-0003-Data.tsv", sep = "\t")

X38429_0004_Data <- read.delim("Datasets/2021_ICPSR_38429/DS0004/38429-0004-Data.tsv", sep = "\t")

```

---

I was then able to combine these datasets into four time series datasets to correspond to the four types of data file given in the NCVS. These four datasets are "address_series", which contains information about the household as reported by the respondent and characteristics of the surrounding area as computed by the Bureau of the Census; "household_series", which contains information about the household as reported by the respondent and characteristics of the surrounding area as computed by the U.S. Census Bureau; "person_series", which contains information about each household member age 12 years and older as reported by that person or proxy, with one record for each qualifying individual; and "incident_series", which contains information drawn from the incident report completed for each household incident or person incident mentioned during the interview.

```{r}
#Creating time series dataframes for each of 4 categories of NCVS data
address_series <- bind_rows(X22929_0001_Data, X22928_0001_Data, X22927_0001_Data, X22926_0001_Data, X22925_0001_Data, X22924_0001_Data, X22923_0001_Data, X22922_0001_Data, X22921_0001_Data, X22920_0001_Data, X22902_0001_Data, X22901_0001_Data, X22900_0001_Data, X22746_0001_Data, X22560_0001_Data, X25141_0001_Data, X26382_0001_Data, X28543_0001_Data, X31202_0001_Data, X34061_0001_Data, X34650_0001_Data, X35164_0001_Data, X36142_0001_Data, X36448_0001_Data, X37296_0001_Data, X36981_0001_Data, X37297_0001_Data, X37645_0001_Data, X38090_0001_Data, X38429_0001_Data)

address_series$Yearonly <- floor(address_series$YEARQ)

household_series <- bind_rows(X22929_0002_Data, X22928_0002_Data, X22927_0002_Data, X22926_0002_Data, X22925_0002_Data, X22924_0002_Data, X22923_0002_Data, X22922_0002_Data, X22921_0002_Data, X22920_0002_Data, X22902_0002_Data, X22901_0002_Data, X22900_0002_Data, X22746_0002_Data, X22560_0002_Data, X25141_0002_Data, X26382_0002_Data, X28543_0002_Data, X31202_0002_Data, X34061_0002_Data, X34650_0002_Data, X35164_0002_Data, X36142_0002_Data, X36448_0002_Data, X37296_0002_Data, X36981_0002_Data, X37297_0002_Data, X37645_0002_Data, X38090_0002_Data, X38429_0002_Data)

household_series$Yearonly <- floor(household_series$YEARQ)

person_series <- bind_rows(X22929_0003_Data, X22928_0003_Data, X22927_0003_Data, X22926_0003_Data, X22925_0003_Data, X22924_0003_Data, X22923_0003_Data, X22922_0003_Data, X22921_0003_Data, X22920_0003_Data, X22902_0003_Data, X22901_0003_Data, X22900_0003_Data, X22746_0003_Data, X22560_0003_Data, X25141_0003_Data, X26382_0003_Data, X28543_0003_Data, X31202_0003_Data, X34061_0003_Data, X34650_0003_Data, X35164_0003_Data, X36142_0003_Data, X36448_0003_Data, X37296_0003_Data, X36981_0003_Data, X37297_0003_Data, X37645_0003_Data, X38090_0003_Data, X38429_0003_Data)

person_series$Yearonly <- floor(person_series$YEARQ)

incident_series <- bind_rows(X22929_0004_Data, X22928_0004_Data, X22927_0004_Data, X22926_0004_Data, X22925_0004_Data, X22924_0004_Data, X22923_0004_Data, X22922_0004_Data, X22921_0004_Data, X22920_0004_Data, X22902_0004_Data, X22901_0004_Data, X22900_0004_Data, X22746_0004_Data, X22560_0004_Data, X25141_0004_Data, X26382_0004_Data, X28543_0004_Data, X31202_0004_Data, X34061_0004_Data, X34650_0004_Data, X35164_0004_Data, X36142_0004_Data, X36448_0004_Data, X37296_0004_Data, X36981_0004_Data, X37297_0004_Data, X37645_0004_Data, X38090_0004_Data, X38429_0004_Data)

incident_series$Yearonly <- floor(incident_series$YEARQ)
```

---

#Measuring the association between economic inequality and crime rates: the extant literature

There has been some research on the connection between economic conditions and crime rates.

In 1968, Columbia University economist Gary Becker offered a seminal neoclassical theoretical framework based on economic costs and benefits to criminal activity. He suggested that crime increases with inequality. The mechanism driving this result comes from the income gap between the poor (i.e. potential criminals without resources) and the rich (i.e. those with resources attractive to potential criminals). According to Becker, a larger income gap causes the net benefits of crime to increase. Thus, greater inequality raises the incentive for criminal activity, which creates the link between inequality and crime rates.^[Gary Becker, Crime and punis hment: an economic approach. J Polit Econ (1968) 76:169–217.]

This neoclassical theory, one suspects, has become popular folklore: of course greater economic inequality leads to more crime. But this theory has hardly been proven in the research.

In 1984, Cleveland State University Professor William Bailey used U.S. city-level data rather than more aggregated data, as well as several cross sections of data covering 1950, 1960, and 1970. He found a positive relationship between poverty levels and homicide rates, and only a slight and insignificant relationship between relative economic deprivation (which he gauged with income inequality) and homicide. He noted that there was only a weak theoretical linkage between homicide and relative economic deprivation.^[William Bailey (Cleveland State Univ. (1984) Poverty, inequality, and city homicide rates. Criminology 22(4):531–550.]

In 1991, Kennedy et al. used census information on 24 Canadian census metropolitan areas for 1971, 1976, and 1981 to test the relationship between family income inequality based on Gini and homicide. They found that homicide rates exhibited a regional pattern, rising from east to west. They found that the effect of inequality on the homicide rate was evident for 1972-1976, but not for 1977-1981. Tangentially, they found that the proportion of young males within a community was associated with higher homicide rates, while unemployment, surprisingly, was *inversely* related to homicide rates.^[Kennedy LW, Silverman RA, Forde DR (1991) Homicide in Urban Canada: testing the impact of economic inequality and social disorganization. Can J Sociol 16(4):397–410.]

In 2000, University of Warwick Professor Morgan Kelly found a positive link in the U.S. at the county level between violent crime and income inequality, but no link between property crime and inequality.^[Morgan Kelly, (2000) Inequality and crime. Rev Econ Stat 82(4):530–539.]

In 2001, Daly et al. examined homicide rates in all 50 U.S. states and 10 Canadian provinces around 1990 against Gini coefficients for total household income and found a positive relationship. Their use of time dummies rather than a time trend reduced the degrees of freedom for their regression.^[Daly, Wilson, & Vasdev, Income inequality and homicide rates in Canada and the United States, Can J Criminol (2001) 43:219–236.]

Also in 2001, Steven Raphael and Rudolf Winter-Ebmer found that in the U.S. unemployment had a significant positive effect on property crimes, but that the association with violent crime was significantly weaker. These researchers considered U.S. state data as to seven felony crimes.^[Steven Raphael and Rudolf Winter-Ebmer, Identifying the Effect of Unemployment on Crime, J. Law and Econ. (2001), Vol. 44, No. 1.]

In 2002, Fajnzylber et al. tested the link between income inequality and violent crime across 39 countries during 1965-95 for homicides and 37 countries during 1970-1994 for robberies. They used the Gini index and determined correlation between it and crime rates. They found that crime rates and inequality are positively correlated and that this correlation reflects causation from inequality to crime rates.^[Pablo Fajnzylber, Daniel Lederman, & Norman Loayza, Inequality and Violent Crime, J. of L. and Econ., (2002), Vol. 45, no. 1.]

In 2008, criminal justice Professor William Pridemore found that there was a positive and significant association between poverty and homicide, but a null association between inequality and homicide, suggesting that prior studies would have benefitted from controlling for poverty.^[William Alex Pridemore, A Methodological Addition to the Cross-National Empirical Literature on Social Structure and Homicide: A First Test of the Poverty-Homicide Thesis, Criminology (2008), Vol. 26, no. 1, 133-154.]

In 2014, economists Hicks and Hicks examined the impact of inequality in consumption expenditures on criminal activity using data on U.S. states for the 1986-2001 period. Their work looked at various measures of violent and property crimes. They also distinguished between income inequality, consumption inequality, and visible consumption inequality. They showed that a positive relationship existed between visible consumption inequality and measures of crime, but this positive relationship didn't hold for property crimes. They also found that income inequality and total consumption inequality explained little about the measures of violent and property crimes.^[Hicks DL, Hicks JH, (2014) Jealous of the Joneses: conspicuous consumption, inequality, and crime. Oxf Econ Pap 66(4):1090–1120.]

In 2016, McMaster University Psychology Professor Martin Daly argued that most homicide results between young men from competitive conflicts over status and position, rivalry over women, or issues of respect and deference. Invoking neoclassical theory, Daly claimed that rising economic inequality created more competition for material goods, and as a result, would lead to higher homicide rates. While he did base his claim on empirical evidence, much of that evidence consisted of cross-sectional plots and correlations of homicide rates in a given year.^[Martin Daly, Killing the Competition: economic inequality and homicide (Routledge 2016).]

Also in 2016, sociologist Marvin D. Krohn used correlational analysis to determine that there was a moderate positive relationship between the rate of unemployment and homicide rates, but a small *negative* relationship between unemployment rates and both the rate of property crimes and the total crime rates.^[ Marvin D. Krohn (1976) Inequality, Unemployment and Crime: A Cross-National Analysis, The Sociological Quarterly, 17:3, 303-313.]

In 2022, Lakehead University Professors Livio Di Matteo and Robert Petrunia observed that in Canada, research indicated a relationship between greater economic inequality and higher homicide rates, though much of that research was based on simple cross sections at high levels of aggregation rather than longer time series. Di Matteo and Petrunia found that support for the link between inequality and homicide rates broke down once they accounted for regional effects. They concluded that much of the literature that finds such a relationship needs to be reexamined within a longer time and more disaggregated framework.^[Livio Di Matteo & Robert Petrunia, Does economic inequality breed murder? An empirical investigation of the relationship between economic inequality and homicide rates in Canadian provinces and CMAs, Empirical Economics (2022) 62:2951-2988.]

The above literature is not a complete bibliography on the subject, but it is representative. It suggests that there are five factors that shape the reliability and validity of studies on the association between economic inequality and crime rates: (1) the type(s) of crime studied; (2) the level of aggregation; (3) the time period studied; (4) whether confounding variables are accounted for; and (5) the method of measurement of inequality/deprivation.

Unlike any scholarship on the topic that has come before, the research I present in this article covers multiple types of crime/criminal conduct, and it does so over a lengthy period of time. Furthermore, it analyzes crime rates based on two measurements of inequality, both of which support each other. All of these original contributions should be considered advantages to this research. To be sure, my research is highly aggregated, which is largely original in the literature, though not completely. And a high level of aggregation isn't a per se advantage; but when most other studies are disaggregated, my research provides support from another angle. Finally, I acknowledge that I do not account for confounding variables. In that sense, this work is largely in line with prior research, and it is a limitation that I intend to remedy in future work.

#Measuring the association between economic inequality and crime rates: individual respondents

##Characteristics of the participants in crime

Let's look first at the individuals involved in the incidents covered by the NCVS, and whether they have changed in line with economic inequality data. The percentage of respondents who were married declined over time:


```{r}
#Graphs on whether respondents are married, count and percent
person_series |> filter(V3015 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Marital status") +
  geom_bar(aes(y = V3015), stat = "identity") +
  xlab("Year") +
  ylab("Married")

person_series |> 
  filter(V3015 <= 6) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3015 == 1) / sum(V3015 < 6)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Here is the data on respondents who were divorced:
```{r}
#Graphs on whether respondents are divorced, count and percent
person_series |> filter(V3015 == 3) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Marital status") +
  geom_bar(aes(y = V3015), stat = "identity") +
  xlab("Year") +
  ylab("Divorced")

person_series |> 
  filter(V3015 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3015 == 3) / sum(V3015 < 6)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

And the data on respondents who were separated:
```{r}
#Graphs on whether respondents are separated, count and percent
person_series |> filter(V3015 == 4) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Marital status") +
  geom_bar(aes(y = V3015), stat = "identity") +
  xlab("Year") +
  ylab("Separated")

person_series |> 
  filter(V3015 <= 6) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3015 == 4) / sum(V3015 < 6)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

And the data on respondents who were never married:
```{r}
#Graphs on whether respondents are never married, count and percent
person_series |> filter(V3015 == 5) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Marital status") +
  geom_bar(aes(y = V3015), stat = "identity") +
  xlab("Year") +
  ylab("Never married")

person_series |> 
  filter(V3015 <= 6) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3015 == 5) / sum(V3015 < 6)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Thus, as to marital status, the number of respondents who were married or separated gradually decreased, and the number who were divorced or never married gradually increased. This probably aligns well with general societal statistics in marital status.

---

Here is the data on number of respondents who were male:
```{r}
#Graphs on whether respondents were male, count and percent
person_series |> filter(V3017 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Sex") +
  geom_bar(aes(y = V3017), stat = "identity") +
  xlab("Year") +
  ylab("Male")

person_series |> 
  filter(V3017 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3017 == 1) / sum(V3017 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

And the data on the number of respondents who were female:
```{r}
#Graphs on whether respondents were female, count and percent
person_series |> filter(V3017 == 2) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Female") +
  geom_bar(aes(y = V3017), stat = "identity") +
  xlab("Year") +
  ylab("Female")
 
person_series |> 
  filter(V3017 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3017 == 2) / sum(V3017 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

These data on the sex of respondents clearly needs further exploration: how can over 75% of respondents be both male and female, with both increasing over time?

---

Starting in 2003, the NVCS offered respondents the opportunity to state their race as white, black, asian, etc., but also white-black, white-Hawaiian, American Indian-Asian, etc. 

---

The number of respondents who said they were "white only" is here:
```{r}
#Graphs on whether respondents were white, count and percent
person_series |> filter(V3023A == 01) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Race") +
  geom_bar(aes(y = V3023A), stat = "identity") +
  xlab("Year") +
  ylab("White only")

person_series |> 
  filter(V3023A <= 21) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3023A == 01) / sum(V3023A < 21)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Here are the numbers on respondents claiming to be "Black only":
```{r}
#Graphs on whether respondents were black, count and percent
person_series |> filter(V3023A == 02) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Race") +
  geom_bar(aes(y = V3023A), stat = "identity") +
  xlab("Year") +
  ylab("Black only")

person_series |> 
  filter(V3023A <= 21) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3023A == 02) / sum(V3023A < 21)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Here are the numbers on respondents claiming to be "Asian only":
```{r}
#Graphs on whether respondents were Asian, count and percent
person_series |> filter(V3023A == 04) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Race") +
  geom_bar(aes(y = V3023A), stat = "identity") +
  xlab("Year") +
  ylab("Asian only")

person_series |> 
  filter(V3023A <= 21) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3023A == 04) / sum(V3023A < 21)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Here are the numbers on respondents claiming to be "2 or 3 races":
```{r}
#Graphs on whether respondents were 2-3 races, count and percent
person_series |> filter(V3023A == 19) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Race") +
  geom_bar(aes(y = V3023A), stat = "identity") +
  xlab("Year") +
  ylab("2 or 3 races")

person_series |> 
  filter(V3023A <= 21) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3023A == 19) / sum(V3023A < 21)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

And here are the numbers on respondents claiming to be "4 or 5 races":
```{r}
#Graphs on whether respondents were 4-5 races, count and percent
person_series |> filter(V3023A == 20) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Race") +
  geom_bar(aes(y = V3023A), stat = "identity") +
  xlab("Year") +
  ylab("4 or 5 races")

person_series |> 
  filter(V3023A <= 21) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3023A == 20) / sum(V3023A < 21)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

The NCVS breaks out into an individual variable a respondent's Hispanic origin. Respondents who claimed to have a Hispanic origin are here:
```{r}
#Graphs on whether respondents were Hispanic, count and percent 
person_series |> filter(V3024 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Hispanic origin") +
  geom_bar(aes(y = V3024), stat = "identity") +
  xlab("Year") +
  ylab("Claiming Hispanic origin")

person_series |> 
  filter(V3024 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3024 == 1) / sum(V3024 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Within the person series--i.e. questions involving the respondent directly, and not the incident, household, or address--the NCVS asks about incidents affecting the respondent.

---

In answer to the question whether the respondent experienced any incidents involving something stolen from the respondent or attempted to be stolen, here is the data on the number of respondents answering "yes" (as opposed to "no" or "refused"). In short, thefts or attempted thefts seem to gradually decrease over time:
```{r}
#Graph on whether something was stolen from respondent, count
person_series |> filter(V3034 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was something stolen from respondent") +
  geom_bar(aes(y = V3034), stat = "identity") +
  xlab("Year") +
  ylab("Something was stolen")

#Code on structural break for whether something was stolen from respondent
break_V3034 <- person_series |> 
  filter(V3034 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3034 == 1) / sum(V3034 < 4))

break2_V3034 <- cpt.mean(break_V3034$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

#Graph with structural break data on whether something was stolen from respondent, percent
person_series |> 
  filter(V3034 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3034 == 1) / sum(V3034 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  ggtitle("Smth stolen/attempted to be stolen") +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_hline(yintercept = mean(break_V3034$Percent) , color = "dark green") +
  geom_smooth(method = "loess", color = "dark green")
```

---

Let's look at the correlation between people who said something was stolen from them and the Gini coefficient and net worth:
```{r}
#Correlation between V3034 and Gini
AggV3034 <- person_series |> 
  filter(V3034 <= 4) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V3034 = sum(V3034 == 1))

ShortV3034 <- filter(AggV3034 , Yearonly < 2021)
Shortgini <- filter(gini , year > 1991)

cor.test(ShortV3034$AnnTotal_V3034, as.numeric(Shortgini$SIPOVGINIUSA))

#Code and correlation between V3034 and top 1% net worth
V3034_ByQuarter <- person_series |> 
  filter(V3034 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V3034 = sum(V3034 == 1))

cor.test(V3034_ByQuarter$AnnTotal_V3034 , Top1Net_Worth_1992_2021$...2)
```

---

In answer to the question whether someone attacked or threatened the respondent with a weapon, by throwing something, by grabbing, punching, or choking, by any rape, attempted rape or other type of sexual attack, any face to face threat, or any attack or threat or use of force by anyone at all, respondents answer "yes", as opposed to "no", or "refused" as follows. Here, such incidents fall until around 2003, and then remain stable. It's tough to draw conclusions from this variable because the question includes so many types of incidents--throwing something is very different from rape, for example:
```{r}
#Graphs on whether someone attacked or threatened the respondent, count and percent
person_series |> filter(V3042 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Attacks, threats") +
  geom_bar(aes(y = V3042), stat = "identity") +
  xlab("Year") +
  ylab("Yes, attacked or threatened")

person_series |> 
  filter(V3042 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3042 == 1) / sum(V3042 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Was something stolen or was the respondent attacked or threatened by someone they know? Respondents who answered "yes," as opposed to "no," or "refused" decreased until 2000, and then remained stable:

```{r}
#Graph on whether respondent was attacked or threatened by someone respondent knows, count
person_series |> filter(V3044 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Thefts or attacks/threats by someone respondent knows") +
  geom_bar(aes(y = V3044), stat = "identity") +
  xlab("Year") +
  ylab("Yes, the theft/attack/threat was by someone respondent knows")

#Code to detect structural breaks in V3044
break_V3044 <- person_series |> 
  filter(V3044 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3044 == 1) / sum(V3044 < 4))

break2_V3044 <- cpt.mean(break_V3044$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V3044, type = "l", xlab = "Index", cpt.width = 4)

#Graph on whether respondent was attacked or threatened by someone respondent knows including structural break, percent
person_series |> 
  filter(V3044 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3044 == 1) / sum(V3044 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  ylab("Yes responses, percent") +
  xlab("Year") +
  geom_hline(yintercept = mean(break_V3044$Percent) , color = "blue") +
  geom_smooth(method = "loess")
```

---

And what about the correlation between whether someone experienced thefts, attacks, or threats by someone they know and the Gini coefficient and net worth?
```{r}
#Correlation between V3044 and Gini
AggV3044 <- person_series |> 
  filter(V3044 <= 4) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V3044 = sum(V3044 == 1))

ShortV3044 <- filter(AggV3044 , Yearonly < 2021)
 
cor.test(ShortV3044$AnnTotal_V3044, as.numeric(Shortgini$SIPOVGINIUSA))

#Code and correlation between Top 1% net worth and V3044
V3044_ByQuarter <- person_series |> 
  filter(V3044 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V3044 = sum(V3044 == 1))

cor.test(V3044_ByQuarter$AnnTotal_V3044 , Top1Net_Worth_1992_2021$...2)
```

---

What was the rate at which respondents experienced forced or coerced unwanted sex, either by strangers or people they know? Respondents answered "yes," as opposed to "no," or "refused" decreasingly until 2000, then it remained stable:
```{r}
#Graphs on the rate at which respondents experienced forced or coerced unwanted sex, count and percent
person_series |> filter(V3046 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Forced or coerced unwanted sex") +
  geom_bar(aes(y = V3046), stat = "identity") +
  xlab("Year") +
  ylab("Forced or coerced unwanted sex was experienced")

person_series |> 
  filter(V3046 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3046 == 1) / sum(V3046 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Forced/coerced sexual activity") +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_line() +
  geom_smooth(method = "loess")
```

---

How about the correlation between the count of people experienced forced or coerced unwanted sex and the Gini coefficient and net worth?
```{r}
#Correlation between V3046 and Gini
AggV3046 <- person_series |> 
  filter(V3046 <= 4) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V3046 = sum(V3046 == 1))

ShortV3046 <- filter(AggV3046 , Yearonly < 2021)

cor.test(ShortV3046$AnnTotal_V3046, as.numeric(Shortgini$SIPOVGINIUSA))

#Code and correlation between V3046 and Top 1% net worth
V3046_ByQuarter <- person_series |> 
  filter(V3046 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V3046 = sum(V3046 == 1))

cor.test(V3046_ByQuarter$AnnTotal_V3046 , Top1Net_Worth_1992_2021$...2)
```

---

At what rate did respondents call the police to report something that happened to them that they thought was a crime (other than incidents respondents already mentioned in the survey)? It appears that respondents decreasingly called police until 2000, and then remained largely stable (though still decreasing gradually). What was its correlation with Gini and net worth?
```{r}
#Graphs on rate at which respondents called the police, count
person_series |> filter(V3048 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Rate at which respondents called police") +
  geom_bar(aes(y = V3048), stat = "identity") +
  xlab("Year") +
  ylab("Respondents did call police")

#Code to determine structural breaks in V3048
break_V3048 <- person_series |> 
  filter(V3048 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3048 == 1) / sum(V3048 < 4))

break2_V3048 <- cpt.mean(break_V3048$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V3048, type = "l", xlab = "Index", cpt.width = 4)

#Graph of V3048 with structural break
person_series |> 
  filter(V3048 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3048 == 1) / sum(V3048 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_hline(yintercept = mean(break_V3048$Percent) , color = "blue") +
  geom_smooth(method = "loess")

#Correlation between V3048 and Gini
AggV3048 <- person_series |> 
  filter(V3048 <= 4) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V3048 = sum(V3048 == 1))

ShortV3048 <- filter(AggV3048 , Yearonly < 2021)

cor.test(ShortV3048$AnnTotal_V3048, as.numeric(Shortgini$SIPOVGINIUSA))

#Code and correlation between V3048 and Top 1% net worth
V3048_ByQuarter <- person_series |> 
  filter(V3048 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V3048 = sum(V3048 == 1))

cor.test(V3048_ByQuarter$AnnTotal_V3048 , Top1Net_Worth_1992_2021$...2)
```

---

Starting at V3084, the NCVS asks about respondents' sexual orientation and gender identity. Starting at V3087, the NCVS asks about active duty status. Starting at V3071, the NCVS asks about job status. I don't code for this either. I don't code for any of these variables because it seems that the insights wouldn't say much about the association between economic inequality and crime rates. In the future, however, as I disaggregate data and perform logistic regressions, I may want to revisit these variables.

---

#Measuring the association between economic inequality and crime rates: nature of the incidents

Let's look now at the incidents themselves, i.e. their characteristics:

---

Let's look first at the instances of forcible entry into homes by count, which has apparently *fallen* over time:
```{r}
#Graphs for a count of instances of forcible entry into homes, histogram and count
incident_series  |> ggplot(aes(x = V4071)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Forcible entry") +
  geom_histogram() +
  xlab("Year") +
  ylab("Incidence of forcible entry")

incident_series |> filter(V4071 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Forcible entry") +
  geom_bar(aes(y = V4071), stat = "identity") +
  xlab("Year") +
  ylab("Incidence of forcible entry")
```

---

Instances of forcible entry into homes by percentage of respondents has remained largely stable over time (percentage understood as the number of people answering "yes" to the question whether they experienced "forcible entry or attempted forcible entry of house/apartment" as a percentage of those answering either yes or no. Answers that were "residue" or "out of universe" were not considered):
```{r}
#Graph of instances of forcible entry into homes, percent
incident_series |> 
  filter(V4071 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Mean = mean(V4071)*100) |>
  ggplot(aes(x = YEARQ, y = Mean)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  ggtitle("Forcible entry into home") +
  xlab("Year") +
  ylab("Yes responses") +
  geom_smooth(method = "loess", color = "dark red")
```

---

Now, what is the correlation between the rate of forcible entries and the Gini coefficient and net worth?
```{r}
#Correlation between V4071 and Gini
AggV4071 <- incident_series |> 
  filter(V4071 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4071 = sum(V4071 == 01))

ShortV4071 <- filter(AggV4071 , Yearonly < 2021)

cor.test(ShortV4071$AnnTotal_V4071, as.numeric(Shortgini$SIPOVGINIUSA))

#Code and correlation between V4071 and Top 1% net worth
V4071_ByQuarter <- incident_series |> 
  filter(V4071 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4071 = sum(V4071 == 01))

cor.test(V4071_ByQuarter$AnnTotal_V4071 , Top1Net_Worth_1992_2021$...2)
```

---

What about crimes that took place on American Indian reservations? This data began in 1999, and has remained stable over time.
```{r}
#Graphs on crimes taking place on American Indian reservations, count and percent
incident_series |> filter(V4023B == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Crime on American Indian reservation?") +
  geom_bar(aes(y = V4023B), stat = "identity") +
  xlab("Year") +
  ylab("Yes, on reservation")

incident_series |> 
  filter(V4023B <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4023B == 1) / sum(V4023B < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

As for correlation between the count of crimes taking place on Indian reservations and the Gini coefficient and net worth:
```{r}
#Correlation between crimes in Indian reservations and Gini
AggV4023B <- incident_series |> 
  filter(V4023B <= 3) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4023B = sum(V4023B == 1)) 

ShortV4023B <- filter(AggV4023B , Yearonly < 2021)

#Correlation between V4023B and Gini:
ShortginiV4023B <- filter(gini , year > 1998)

cor.test(ShortV4023B$AnnTotal_V4023B , as.numeric(ShortginiV4023B$SIPOVGINIUSA))
```

---

Where did the incident occur (i.e. in respondent's dwelling, vacation home, apartment hall, yard, etc.)? As for one's dwelling, attached garage, or enclosed porch, it appears that the rate was mostly stable until 2005, increased until 2010, and then gradually fell to a period low currently. This is interesting, and bears further exploration:
```{r}
#Graph on where the incident occurred, count
incident_series |> filter(V4024 == 01) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Incidents in respondent's dwelling, attached garage, or enclosed porch") +
  geom_bar(aes(y = V4024), stat = "identity") +
  xlab("Year") +
  ylab("Rate of incidents in respondent's dwelling, attached garage, or enclosed porch")

#Code for determining structural break in V4024
break_V4024 <- incident_series |> 
  filter(V4024 <= 28) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4024 == 01) / sum(V4024 < 28))

break2_V4024 <- cpt.mean(break_V4024$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V4024, type = "l", xlab = "Index", cpt.width = 4)

#Graph of V4024 with structural break, percent
incident_series |> 
  filter(V4024 <= 28) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4024 == 01) / sum(V4024 < 28)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  ggtitle("Incident in dwelling, garage, porch") +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_hline(yintercept = mean(break_V4024$Percent) , color = "dark green") +
  geom_smooth(method = "loess", color = "dark green")

#Correlation between V4024 and Gini
incident_series$Yearonly <- floor(incident_series$YEARQ)

AggV4024 <- incident_series |> 
  filter(V4024 <= 28) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4024 = sum(V4024 == 01))

ShortV4024 <- filter(AggV4024 , Yearonly < 2021)

cor.test(ShortV4024$AnnTotal_V4024, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between Top 1% net worth by quarter and V4024
V4024_ByQuarter <- incident_series |> 
  filter(V4024 <= 28) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4024 = sum(V4024 == 01))

cor.test(V4024_ByQuarter$AnnTotal_V4024 , Top1Net_Worth_1992_2021$...2)
```

---

There are many other locations provided for in V4024. I may want to revisit them (i.e. rate of incidents occurring in offices or schools).

---

Now let's look at incidents involving offenders who had a right to be present where the offense took place. As a count, the rate has gone down over time:
```{r}
#Graph on whether the offender had a right to be at the incident place, count
incident_series |> filter(V4025 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Offender had a right to be there") +
  geom_bar(aes(y = V4025), stat = "identity") +
  xlab("Year") +
  ylab("Offender had a right to be there")
```

---

As a percentage, incidents during which the offender had a right to remain present fluctuate relatively steadily, but don't appear to rise or fall consistently over time--on average, the rate remains stable:

```{r}
#Graph on whether the offender had a right to be at the incident place, percent
incident_series |> 
  filter(V4025 <= 5) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4025 == 1) / sum(V4025 < 5)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

How about the correlation between "yes" answers to whether the offender had a right to be at the incident location and the Gini coefficient?
```{r}
#Correlation between whether offender had a right to be there and Gini
AggV4025 <- incident_series |> 
  filter(V4025 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4025 = sum(V4025 == 01))

ShortV4025 <- filter(AggV4025 , Yearonly < 2021)

cor.test(ShortV4025$AnnTotal_V4025, as.numeric(Shortgini$SIPOVGINIUSA))
```

---

As for the times of day in which offenses occur, these remain pretty stable over time. Here is the data on the percentage of offenses taking place between 9 pm and midnight: 
```{r}
#Graph for time of day of the incident, 9 pm to midnight, percent
incident_series |> 
  filter(V4021B <= 10) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4021B == 6) / sum(V4021B < 10)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

3 pm to 6 pm:
```{r}
#Graph for time of day of the incident, 3 pm to 6 pm, percent
incident_series |> 
  filter(V4021B <= 10) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4021B == 3) / sum(V4021B < 10)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Midnight to 6 am (these times gradually see a greater share of offenses):
```{r}
#Graph for time of day of the incident, midnight to 6 am, percent
incident_series |> 
  filter(V4021B <= 10) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4021B == 7) / sum(V4021B < 10)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

6 am to noon (these times see a slight decline in percentages of total offenses):
```{r}
#Graph for time of day of the incident, 6 am to noon, percent
incident_series |> 
  filter(V4021B <= 10) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4021B == 1) / sum(V4021B < 10)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

What is the correlation between incidents taking place at 6 am to noon and the Gini coefficient?
```{r}
#Correlation between 6 am to noon and Gini
AggV4021B <- incident_series |> 
  filter(V4021B <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4021B = sum(V4021B == 01))

ShortV4021B <- filter(AggV4021B , Yearonly < 2021)

ShortginiV4021B <- filter(gini , year > 1997)

cor.test(ShortV4021B$AnnTotal_V4021B, as.numeric(ShortginiV4021B$SIPOVGINIUSA))
```

---

And noon to 3 pm:
```{r}
#Graph for time of day of the incident, noon to 3 pm, percent
incident_series |> 
  filter(V4021B <= 10) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4021B == 2) / sum(V4021B < 10)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

What about incidents in which the offender actually got inside the victim's home/apartment/room/garage/etc., as opposed, for example, of offenders remaining outside? As a count, the numbers appear to fall after 1994. As a percentage, they are consistent until 2005, then jump down, and then remain consistent:
```{r}
#Graphs on incidents in which offender got inside a victim's home/apartment/room/garage/etc., count and percent
incident_series |> filter(V4026 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Offender got inside") +
  geom_bar(aes(y = V4025), stat = "identity") +
  xlab("Year") +
  ylab("Offender got inside")

incident_series |> 
  filter(V4026 <= 5) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4026 == 1) / sum(V4026 < 5)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

How about the correlation between "yes" answers to whether the offender got inside, and the Gini coefficient? Here, there is a correlation of -0.304, which is a moderate negative association.
```{r}
#Correlation between V4026 and Gini
AggV4026 <- incident_series |> 
  filter(V4026 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4026 = sum(V4026 == 01))

ShortV4026 <- filter(AggV4026 , Yearonly < 2021)

cor.test(ShortV4026$AnnTotal_V4026, as.numeric(Shortgini$SIPOVGINIUSA))
```

---

Was any household member present when the offense occurred? The absolute count seems to fall after 1995, and the percentage fluctuates, but remains largely consistent over time:
```{r}
#Graphs on whether a household member was present when the offense occurred, count and percent
incident_series |> filter(V4045 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Household member present") +
  geom_bar(aes(y = V4025), stat = "identity") +
  xlab("Year") +
  ylab("Household member present")

incident_series |> 
  filter(V4045 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4045 == 1) / sum(V4045 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

```{r}
#Graphs on whether there was evidence of forcible entry
incident_series |> filter(V4028 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Evidence of forcible entry?") +
  geom_bar(aes(y = V4028), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4028 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Did the offender have a weapon, which includes a gun, knife, or something to use as a weapon, like a bottle or wrench? While the data here by count falls after 1995 until around 2007, it then ticks up slowly. The same can be said for the percentage of offenses when the offender had a weapon.
```{r}
#Graph on whether the offender had any type of weapon, count
incident_series |> filter(V4049 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Offender had a weapon") +
  geom_bar(aes(y = V4049), stat = "identity") +
  xlab("Year") +
  ylab("Offender had a weapon")

#Code on determining structural break in V4049
break_V4049 <- incident_series |> 
  filter(V4049 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4049 == 1) / sum(V4049 < 4))

break2_V4049 <- cpt.mean(break_V4049$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V4049, type = "l", xlab = "Index", cpt.width = 4)

#Graph of V4049 with structural break, percent
incident_series |> 
  filter(V4049 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4049 == 1) / sum(V4049 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  ggtitle("Offender with a weapon") +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_hline(yintercept = mean(break_V4049$Percent) , color = "dark red") +
  geom_smooth(method = "loess", color = "dark red")
```

---

What about the correlation between use of a weapon and the Gini coefficient? Here, the correlation is -0.375, which is moderately negative--as economic inequality went up, the use of a weapon tended to go down.
```{r}
#Correlation between V4049 and Gini
AggV4049 <- incident_series |> 
  filter(V4049 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4049 = sum(V4049 == 01))

ShortV4049 <- filter(AggV4049 , Yearonly < 2021)

cor.test(ShortV4049$AnnTotal_V4049, as.numeric(Shortgini$SIPOVGINIUSA))

#Code and correlation between V4049 and Top 1% net worth
V4049_ByQuarter <- incident_series |> 
  filter(V4049 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4049 = sum(V4049 == 01))

cor.test(V4049_ByQuarter$AnnTotal_V4049 , Top1Net_Worth_1992_2021$...2)
```

---

What about the presence of a handgun? Contrary to popular belief, the U.S. isn't awash in criminals with guns. Use of guns by offenders fell since 1995 and hit a consistent low by the early 2000s. As a percentage, gun use by offenders has remained pretty stable.

```{r}
#Graph on presence of a handgun, count
incident_series |> filter(V4051 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Handgun present") +
  geom_bar(aes(y = V4051), stat = "identity") +
  xlab("Year") +
  ylab("Presence of handgun")

#Code for determining structural break in V4051
break_V4051 <- incident_series |> 
  filter(V4051 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Mean = mean(V4051)*100)

break2_V4051 <- cpt.mean(break_V4051$Mean, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V4051, type = "l", xlab = "Index", cpt.width = 4)

#Graph of V4051 with structural break
incident_series |> 
  filter(V4051 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Mean = mean(V4051)*100) |>
  ggplot(aes(x = YEARQ, y = Mean)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
    ggtitle("Handgun present?") +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses") +
  geom_hline(yintercept = mean(break_V4051$Mean) , color = "darkred") +
  geom_smooth(method = "loess", color = "dark red")
```

---

How about the correlation between use of a *handgun*, as opposed to any weapon, and the Gini coefficient? Here, the correlation is -0.345, which, again, is moderately negative. As economic inequality went up, use of a handgun tended to go down.
```{r}
#Correlation between V4051 and Gini
AggV4051 <- incident_series |> 
  filter(V4051 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4051 = sum(V4051 == 01))

ShortV4051 <- filter(AggV4051 , Yearonly < 2021)

cor.test(ShortV4051$AnnTotal_V4051, as.numeric(Shortgini$SIPOVGINIUSA))

#Code and correlation between V4051 and Top 1% net worth
V4051_ByQuarter <- incident_series |> 
  filter(V4051 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4051 = sum(V4051 == 01))

cor.test(V4051_ByQuarter$AnnTotal_V4051 , Top1Net_Worth_1992_2021$...2)
```

---

What about guns other than handguns, such as rifles or shotguns? We see numbers similar to those for handguns:

```{r}
#Graph on guns other than handguns being present, count and percent
incident_series |> filter(V4052 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Guns other than handguns") +
  geom_bar(aes(y = V4052), stat = "identity") +
  xlab("Year") +
  ylab("Guns other than handguns")

break_V4052 <- incident_series |> 
  filter(V4052 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Mean = mean(V4052)*100)

incident_series |> 
  filter(V4052 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Mean = mean(V4052)*100) |>
  ggplot(aes(x = YEARQ, y = Mean)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Guns, not handguns, present") +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses") +
  geom_hline(yintercept = mean(break_V4052$Mean) , color = "darkred") +
  geom_smooth(method = "loess", color = "dark red")
```

---

And the correlation between use of guns other than handguns and the Gini coefficient and net worth?
```{r}
#Correlation between guns other than handguns and Gini
AggV4052 <- incident_series |> 
  filter(V4052 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4052 = sum(V4052 == 01))

ShortV4052 <- filter(AggV4052 , Yearonly < 2021)

cor.test(ShortV4052$AnnTotal_V4052, as.numeric(Shortgini$SIPOVGINIUSA))

#Code and correlation between V4052 and top 1% net worth
V4052_ByQuarter <- incident_series |> 
  filter(V4052 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4052 = sum(V4052 == 01))

cor.test(V4052_ByQuarter$AnnTotal_V4052 , Top1Net_Worth_1992_2021$...2)
```

---

What did respondents say about whether the offender hit them, knocked them down, or actually attacked them in any way? By count and percentage of offenses, this number falls gradually and consistently since 1992.

```{r}
#Graph on whether offender hit, knocked down, or actually attacked respondent, count
incident_series |> filter(V4059 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Victim was hit, knocked down, or actually attacked") +
  geom_bar(aes(y = V4059), stat = "identity") +
  xlab("Year") +
  ylab("Victim hit, knocked down, or actually attacked")

#Code to determine structural break in V4059
break_V4059 <- incident_series |> 
  filter(V4059 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4059 == 1) / sum(V4059 < 3))

break2_V4059 <- cpt.mean(break_V4059$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V4059, type = "l", xlab = "Index", cpt.width = 4)

#Graph of V4059 with structural break, percent
incident_series |> 
  filter(V4059 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4059 == 1) / sum(V4059 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  ggtitle("Hit, knocked down, actually attacked") +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_hline(yintercept = mean(break_V4059$Percent) , color = "dark red") +
  geom_smooth(method = "loess", color = "dark red")
```

---

And the correlation between whether the offender hit respondents, knocked them down, or actually attacked them in any way, and the Gini coefficient and net worth?
```{r} 
#Correlation between V4059 and Gini
AggV4059 <- incident_series |> 
  filter(V4059 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4059 = sum(V4059 == 01))

ShortV4059 <- filter(AggV4059 , Yearonly < 2021)

cor.test(ShortV4059$AnnTotal_V4059, as.numeric(Shortgini$SIPOVGINIUSA))

#Code and correlation between V4059 and Top 1% net worth
V4059_ByQuarter <- incident_series |> 
  filter(V4059 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4059 = sum(V4059 == 01))

cor.test(V4059_ByQuarter$AnnTotal_V4059 , Top1Net_Worth_1992_2021$...2)
```

---

Numbers on when offenders *tried* to attack appear closely positively correlated to data on when offenders actually did attack, which is to be expected. In short, these numbers gradually fell since 1992. 
```{r}
#Graphs of V4061, count and percent
incident_series |> filter(V4061 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Offender tried to attack") +
  geom_bar(aes(y = V4061), stat = "identity") +
  xlab("Year") +
  ylab("Offender tried to attack")

incident_series |> 
  filter(V4061 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4061 == 1) / sum(V4061 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

As to the correlation between attempted attacks and the Gini coefficient, we have a nearly identical correlation to that involving actual attacks, -0.385.
```{r}
#Correlation between V4061 and Gini
AggV4061 <- incident_series |> 
  filter(V4061 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4061 = sum(V4061 == 01))

ShortV4061 <- filter(AggV4061 , Yearonly < 2021)

cor.test(ShortV4061$AnnTotal_V4061, as.numeric(Shortgini$SIPOVGINIUSA))
```

---

Oddly, when asked if offenders *threatened* them with harm, the percentage answering "yes" fell until about 2012, and then increased rather sharply:
```{r}
#Graph of V4063, count
incident_series |> filter(V4063 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Offender threatened someone with harm") +
  geom_bar(aes(y = V4063), stat = "identity") +
  xlab("Year") +
  ylab("Offender threatened someone with harm")

#Structural break code, V4063
break_V4063 <- incident_series |> 
  filter(V4063 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4063 == 1) / sum(V4063 < 3))

break2_V4063 <- cpt.mean(break_V4063$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V4063, type = "l", xlab = "Index", cpt.width = 4)

#Graph of V4063 with structural break, percent
incident_series |> 
  filter(V4063 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4063 == 1) / sum(V4063 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Threat with harm") +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_hline(yintercept = mean(break_V4063$Percent) , color = "cadetblue4") +
  geom_smooth(method = "loess", color = "cadetblue4")
```

---

What about the correlation between threats and the Gini coefficient and net worth? Given that threats went down until appx. 2012, and then up, so this overall correlation perhaps doesn't say much.
```{r}
#Correlation between V4063 and Gini
AggV4063 <- incident_series |> 
  filter(V4063 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4063 = sum(V4063 == 01))

ShortV4063 <- filter(AggV4063 , Yearonly < 2021)

cor.test(ShortV4063$AnnTotal_V4063, as.numeric(Shortgini$SIPOVGINIUSA))

#Code and correlation between V4063 and Top 1% net worth
V4063_ByQuarter <- incident_series |> 
  filter(V4063 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4063 = sum(V4063 == 01))

cor.test(V4063_ByQuarter$AnnTotal_V4063 , Top1Net_Worth_1992_2021$...2)
```

---

Was something taken without permission? Starting in 1995, the numbers here seem to go down (prior to 1995, there appears to be some data anomaly):

```{r}
#Graph of V4066, count
incident_series |> filter(V4066 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Something taken without permission") +
  geom_bar(aes(y = V4066), stat = "identity") +
  xlab("Year") +
  ylab("Offender threatened someone with harm")

#Structural break code, V4066
break_V4066 <- incident_series |> 
  filter(V4066 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Mean = mean(V4066)*100)

break2_V4066 <- cpt.mean(break_V4066$Mean, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V4066, type = "l", xlab = "Index", cpt.width = 4)

#Graph, V4066 with structural break, percent
incident_series |> 
  filter(V4066 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Mean = mean(V4066)*100) |>
  ggplot(aes(x = YEARQ, y = Mean)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  geom_hline(yintercept = mean(break_V4066$Mean) , color = "dark green") +
  geom_smooth(method = "loess", color = "dark green") +
  ggtitle("Was something taken without permission") +
  xlab("Year") +
  ylab("Yes responses")
```

---

Let's test the correlation between whether something was taken and the Gini coefficient and net worth, starting in 1995.
```{r}
#Correlation between V4066 and Gini
AggV4066 <- incident_series |> 
  filter(V4066 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4066 = sum(V4066 == 01))

ShortV4066 <- filter(AggV4066 , Yearonly < 2021, Yearonly > 1994)

ShortginiV4066 <- filter(gini , year > 1994)

cor.test(ShortV4066$AnnTotal_V4066, as.numeric(ShortginiV4066$SIPOVGINIUSA))

#Code and correlation between V4066 and top 1% net worth
V4066_ByQuarter <- incident_series |> 
  filter(V4066 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4066 = sum(V4066 == 01))

cor.test(V4066_ByQuarter$AnnTotal_V4066 , Top1Net_Worth_1992_2021$...2)
```

---

Along with threats of harm, threats to take something fell until around 2010, and then gradually began rising. One starts to see the possibility that while actual harm and taking of things has been decreasing, *threats* to harm or take things has been increasing:

```{r}
#Graph of V4067, count and percent
incident_series |> filter(V4067 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Offender attempted or threatened to take something") +
  geom_bar(aes(y = V4067), stat = "identity") +
  xlab("Year") +
  ylab("Offender threatened or attempted to take something")

incident_series |> 
  filter(V4067 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Mean = mean(V4067)*100) |>
  ggplot(aes(x = YEARQ, y = Mean)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Attempt/threat to take something") +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses") +
  geom_smooth(method = "loess", color = "cadetblue4")
```

---

The correlation between attempts/threats to take something and the Gini coefficient is -0.205, suggesting a weak negative correlation: as economic inequality increased, attempts/threats to take something tended, to a small extent, to go down. The correlation as to net worth is similar.
```{r}
#Correlation between V4067 and Gini
AggV4067 <- incident_series |> 
  filter(V4067 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4067 = sum(V4067 == 01))

ShortV4067 <- filter(AggV4067 , Yearonly < 2021)

cor.test(ShortV4067$AnnTotal_V4067, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between V4067 and top 1% net worth
V4067_ByQuarter <- incident_series |> 
  filter(V4067 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4067 = sum(V4067 == 01))

cor.test(V4067_ByQuarter$AnnTotal_V4067 , Top1Net_Worth_1992_2021$...2)
```

---

As for offenses harassing, arguing, or using abusive language, these numbers remain pretty consistent over time:

```{r}
#Graph of V4068, count and percent
incident_series |> filter(V4068 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Offender harassed, argued, or used abusive language") +
  geom_bar(aes(y = V4068), stat = "identity") +
  xlab("Year") +
  ylab("Offender harassed, argued, or used abusive language")

incident_series |> 
  filter(V4068 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Mean = mean(V4068)*100) |>
  ggplot(aes(x = YEARQ, y = Mean)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Harassment, arguing, abusive language") +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses") +
  geom_smooth(method = "loess", color = "cadetblue4")

#Correlation between V4068 and Gini
AggV4068 <- incident_series |> 
  filter(V4068 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4068 = sum(V4068 == 01))

ShortV4068 <- filter(AggV4068 , Yearonly < 2021)

cor.test(ShortV4068$AnnTotal_V4068, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between V4068 and top 1% net worth
V4068_ByQuarter <- incident_series |> 
  filter(V4068 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4068 = sum(V4068 == 01))

cor.test(V4068_ByQuarter$AnnTotal_V4068 , Top1Net_Worth_1992_2021$...2)
```

---

What about unwanted sexual contact with force? The statistics here suggest something odd about the data, which I need to explore further:
```{r}
#Graph of V4069, bar plot and mean
incident_series |> filter(V4069 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Unwanted sexual contact with force") +
  geom_bar(aes(y = V4069), stat = "identity") +
  xlab("Year") +
  ylab("Unwanted sexual contact with force")

incident_series |> 
  filter(V4069 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Mean = mean(V4069)*100) |>
  ggplot(aes(x = YEARQ, y = Mean)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Was there sexual contact *without* force? Like sexual contact with force, above, the data here seems odd and bears further exploration:
```{r}
#Graph of V4070, count and percent
incident_series |> filter(V4070 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Sexual contact without force") +
  geom_bar(aes(y = V4070), stat = "identity") +
  xlab("Year") +
  ylab("Yes, there was sexual contact without force")

incident_series |> 
  filter(V4070 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4070 == 1) / sum(V4070 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Was there forcible entry or attempted forcible entry of a car? The rate of such an incident appears very stable over time:
```{r}
#Graph of V4072, count and percent
incident_series |> filter(V4072 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Forcible entry of a car") +
  geom_bar(aes(y = V4072), stat = "identity") +
  xlab("Year") +
  ylab("Yes, forcible entry of a car")

incident_series |> 
  filter(V4072 <= 3) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4072 == 1) / sum(V4072 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  ggtitle("Forcible entry into car") +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_smooth(method = "loess", color = "dark red")
```

---

Let's see the correlation between forcible or attempted forcible entry of a car and the Gini coefficient and net worth.
```{r}
#Correlation between V4072 and Gini
AggV4072 <- incident_series |> 
  filter(V4072 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4072 = sum(V4072 == 01))

ShortV4072 <- filter(AggV4072 , Yearonly < 2021)

cor.test(ShortV4072$AnnTotal_V4072, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between V4072 and top 1% net worth
V4072_ByQuarter <- incident_series |> 
  filter(V4072 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4072 = sum(V4072 == 01))

cor.test(V4072_ByQuarter$AnnTotal_V4072 , Top1Net_Worth_1992_2021$...2)
```

---

Was there a verbal threat of rape? Along with the increase in general threats, noted above, there appears to be a gradual increase in threats of rape as well since 2000:
```{r}
#Graph of V4078, count and percent
incident_series |> filter(V4078 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Verbal threat of rape?") +
  geom_bar(aes(y = V4025), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4078 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4078 == 1) / sum(V4078 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Threat of rape") +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_smooth(method = "loess")
```

---

How about the correlation between verbal threats of rape and the Gini coefficient and net worth? Here, there appears to be virtually no correlation.
```{r}
#Correlation between V4078 and Gini
AggV4078 <- incident_series |> 
  filter(V4078 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4078 = sum(V4078 == 01))

ShortV4078 <- filter(AggV4078 , Yearonly < 2021)

cor.test(ShortV4078$AnnTotal_V4078, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between V4078 and top 1% net worth
V4078_ByQuarter <- incident_series |> 
  filter(V4078 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4078 = sum(V4078 == 01))

cor.test(V4078_ByQuarter$AnnTotal_V4078 , Top1Net_Worth_1992_2021$...2)
```

---

What about threats to kill? Interestingly, it appears that threats to kill saw a slight but consistent decrease over time:
```{r}
#Graph of V4079, count and percent
incident_series |> filter(V4079 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Verbal threat to kill?") +
  geom_bar(aes(y = V4079), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4079 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4079 == 1) / sum(V4079 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

And the correlation between threats to kill and the Gini coefficient? Interestingly, threats to kill have a moderate negative association with the Gini coefficient, as the value is -0.368.
```{r}
#Correlation between V4079 and Gini
AggV4079 <- incident_series |> 
  filter(V4079 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4079 = sum(V4079 == 01))

ShortV4079 <- filter(AggV4079 , Yearonly < 2021)

cor.test(ShortV4079$AnnTotal_V4079, as.numeric(Shortgini$SIPOVGINIUSA))
```

---

What about any verbal threat of attack other than to kill or rape? These types of threats appear to fluctuate greatly, but ultimately regress to a common mean:
```{r}
#Graph of V4080, count
incident_series |> filter(V4080 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Verbal threat of attack other than to kill or rape?") +
  geom_bar(aes(y = V4080), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

#Structural break code, V4080
break_V4080 <- incident_series |> 
  filter(V4080 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4080 == 1) / sum(V4080 < 3))

break2_V4080 <- cpt.mean(break_V4080$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V4080, type = "l", xlab = "Index", cpt.width = 4)

#Graph of V4080 with structural break, percent
incident_series |> 
  filter(V4080 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4080 == 1) / sum(V4080 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Verbal threat not kill or rape") +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_hline(yintercept = mean(break_V4080$Percent) , color = "cadetblue4") +
  geom_smooth(method = "loess", color = "cadetblue4")
```

---

We would expect the correlation here to be nearly zero, as verbal threats other than to kill or rape regress to a mean, but the actual value as to Gini is -0.346, suggesting that declines in this value outstrip increases. 
```{r}
#Correlation between V4080 and Gini
AggV4080 <- incident_series |> 
  filter(V4080 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4080 = sum(V4080 == 01))

ShortV4080 <- filter(AggV4080 , Yearonly < 2021)

cor.test(ShortV4080$AnnTotal_V4080, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between V4080 and top 1% net worth
V4080_ByQuarter <- incident_series |> 
  filter(V4080 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4080 = sum(V4080 == 01))

cor.test(V4080_ByQuarter$AnnTotal_V4080 , Top1Net_Worth_1992_2021$...2)
```

---

What about verbal threats of sexual assault other than rape? These have largely stayed stable, with perhaps a slight increase over time:
```{r}
#Graph of V4081, count and percent
incident_series |> filter(V4081 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Verbal threat of sexaul assualt other than rape?") +
  geom_bar(aes(y = V4081), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4081 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4081 == 1) / sum(V4081 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Verbal threat, sexual assault not rape") +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_smooth(method = "loess")
```

---

And the correlation between verbal threats of sexual assault other than rape and the Gini coefficient and net worth? Such verbal threats tend to decline as economic inequality increases, with a value of -0.209 as to Gini.
```{r}
#Correlation between V4081 and Gini
AggV4081 <- incident_series |> 
  filter(V4081 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4081 = sum(V4081 == 01))

ShortV4081 <- filter(AggV4081 , Yearonly < 2021)

cor.test(ShortV4081$AnnTotal_V4081, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between V4081 and top 1% net worth
V4081_ByQuarter <- incident_series |> 
  filter(V4081 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4081 = sum(V4081 == 01))

cor.test(V4081_ByQuarter$AnnTotal_V4081 , Top1Net_Worth_1992_2021$...2)
```

---

Did the incident involve a weapon present or a threat with a weapon? Such incidents have fallen slightly over time. This data and the above suggests that what could be called *mere threats* are stable or mostly falling, whereas *actual threats* (those involving actually attacks or threats with something substantive present, like a weapon) have mostly fallen over time.
```{r}
#Graph of V4084, count and percent
incident_series |> filter(V4084 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Weapon present or threatened with weapon?") +
  geom_bar(aes(y = V4084), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4084 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4084 == 1) / sum(V4084 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_smooth(method = "loess")
```

---

What was the rate of incidents during which someone was shot at, but was missed? The rate of such incidents has remained stable over time.
```{r}
#Graph of V4085, count and percent
incident_series |> filter(V4085 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Shot at but missed?") +
  geom_bar(aes(y = V4085), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4085 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4085 == 1) / sum(V4085 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

And the correlation between being shot at but missed and the Gini coefficient? Here, the correlation is relatively significant, at -0.426, suggesting that as economic inequality goes up, shooting incidents (at least where the respondent was missed) tend to go down.
```{r}
#Correlation between V4085 and Gini
AggV4085 <- incident_series |> 
  filter(V4085 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4085 = sum(V4085 == 01))

ShortV4085 <- filter(AggV4085 , Yearonly < 2021)

cor.test(ShortV4085$AnnTotal_V4085, as.numeric(Shortgini$SIPOVGINIUSA))
```

---

Starting at V4085, there are many variables further describing the incident (attempted attack with sharp object, other weapon, object thrown at person, person followed or surrounded, someone tried to hit, slap, grab another, etc.). I don't code for these, because they are getting very detailed. I don't need them right now, but may in the future.

---

What about actual victimization? What was the rate of respondents being raped? This appears stable until 2010, and then begins to increase.
```{r}
#Graph of V4094, count
incident_series |> filter(V4094 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Were you raped?") +
  geom_bar(aes(y = V4094), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

#Structural break code, V4094
break_V4094 <- incident_series |> 
  filter(V4094 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4094 == 1) / sum(V4094 < 3))

break2_V4094 <- cpt.mean(break_V4094$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V4094, type = "l", xlab = "Index", cpt.width = 4)

#Graph of V4094 with structural break, percent
incident_series |> 
  filter(V4094 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4094 == 1) / sum(V4094 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Respondent raped") +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_hline(yintercept = mean(break_V4094$Percent) , color = "blue") +
  geom_smooth(method = "loess")
```

---

And the correlation of rapes to the Gini coefficient and net worth? There is a weak negative association, at -0.208 as to Gini.
```{r}
#Correlation between V4094 and Gini
AggV4094 <- incident_series |> 
  filter(V4094 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4094 = sum(V4094 == 01))

ShortV4094 <- filter(AggV4094 , Yearonly < 2021)

cor.test(ShortV4094$AnnTotal_V4094, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between V4094 and top 1% net worth
V4094_ByQuarter <- incident_series |> 
  filter(V4094 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4094 = sum(V4094 == 01))

cor.test(V4094_ByQuarter$AnnTotal_V4094 , Top1Net_Worth_1992_2021$...2)
```

---

What was the rate of respondents subject to attempted rape? *Attempted* rapes follow a different course than actual rapes: they are relatively stable over time, with perhaps a slight increase since around 1997.
```{r}
#Graph of V4095, count and percent
incident_series |> filter(V4095 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Victim of attempted rape?") +
  geom_bar(aes(y = V4095), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4095 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4095 == 1) / sum(V4095 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_smooth(method = "loess")
```

---

What was the rate of respondents who were shot? It appears that the rate is remained stable and low over time:
```{r}
#Graph of V4097, count and percent
incident_series |> filter(V4097 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Were you shot?") +
  geom_bar(aes(y = V4097), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4097 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4097 == 1) / sum(V4097 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Graph of V4098, count and percent
incident_series |> filter(V4098 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Were you shot at, but were missed?") +
  geom_bar(aes(y = V4098), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4098 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4098 == 1) / sum(V4098 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

How about the correlation between respondents being shot and the Gini coefficient? As expected, this is similar to the above correlation between being shot at and missed and Gini. Here, the value is -0.320.
```{r}
#Correlation between V4097 and Gini
AggV4097 <- incident_series |> 
  filter(V4097 <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4097 = sum(V4097 == 01))

ShortV4097 <- filter(AggV4097 , Yearonly < 2021)

cor.test(ShortV4097$AnnTotal_V4097, as.numeric(Shortgini$SIPOVGINIUSA))
```

```{r}
#Graph of V4105, count and percent
incident_series |> filter(V4105 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Were you hit, slapped, or knocked down?") +
  geom_bar(aes(y = V4105), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4105 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4105 == 1) / sum(V4105 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Graph of V4106, count and percent
incident_series |> filter(V4106 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Were you grabbed, held, or tripped?") +
  geom_bar(aes(y = V4106), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4106 <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4106 == 1) / sum(V4106 < 3)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

Starting at V4098, there are many variables detailing specific characteristics of incidents. I may revisit these, but for now, for my purposes, I have enough of this type of data.

Starting at V4110, the NCVS survey details the injuries that respondents suffered, if any. I don't code for these now, but may want to come back to them. They may, for example, reveal information about the seriousness of any particular incident. The same goes for medical care, which the NCVS details starting at V4126, and ancillary problems (i.e. psychological impacts) that victims might have experienced, starting at V4140B1. Starting at V4140B12, the NCVS asks about professional help sought as a result of the incident. Starting at V4140B20, the NCVS asks about physical problems that resulted from the incident.

Starting at V4141, the NCVS asks about any self-protection the respondent took.

#Measuring the association between economic inequality and crime rates: characteristics of the offender

What was the sex of the offender? Most offenders are male over time; this isn't a surprise. Interestingly, though, until around 2012, the rate of male offenders went down, and the rate of female offenders went up. After 2012, the rate of male offenders began to increase and the rate of female offenders began to decrease, returning the numbers to the "norm."
```{r}
#Graph of V4236, re males, count
incident_series |> filter(V4236 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender male?") +
  geom_bar(aes(y = V4236), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

#Structural break code, males
break_V4236 <- incident_series |> 
  filter(V4236 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4236 == 1) / sum(V4236 < 4))

break2_V4236 <- cpt.mean(break_V4236$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V3048, type = "l", xlab = "Index", cpt.width = 4)

#Graph of males with structural break, percent
incident_series |> 
  filter(V4236 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4236 == 1) / sum(V4236 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
  geom_line() +
  geom_hline(yintercept = mean(break_V4236$Percent) , color = "purple3") +
  geom_smooth(method = "loess") +
  xlab("Year") +
  ylab("Male offenders, by percent")
```

```{r}
#Graph of V4236, re females, count
incident_series |> filter(V4236 == 2) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender female?") +
  geom_bar(aes(y = V4236), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

#Structural break code, females
break_V4236 <- incident_series |> 
  filter(V4236 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4236 == 2) / sum(V4236 < 4))

break2_V4236 <- cpt.mean(break_V4236$Percent, penalty = "BIC", method = "BinSeg", Q = 5)

plot(break2_V4236, type = "l", xlab = "Index", cpt.width = 4)

#Graph of females with structural break, percent
incident_series |> 
  filter(V4236 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4236 == 2) / sum(V4236 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  geom_hline(yintercept = mean(break_V4236$Percent) , color = "blue") +
  geom_smooth(method = "loess") +
  xlab("Year") +
  ylab("Female offenders, percent")
```

---

What is the correlation between males being the offenders and the Gini coefficient? The value here is -0.359, with a similar number as to net worth, but there's a caveat: there is an inflection point at 2012. I'll need to determine the correlation before and after that date.
```{r}
#Correlation between V4236, males, and Gini
AggV4236_Male <- incident_series |> 
  filter(V4236 <= 4) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4236 = sum(V4236 == 1))

ShortV4236_Male <- filter(AggV4236_Male , Yearonly < 2021)

cor.test(ShortV4236_Male$AnnTotal_V4236 , as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between male offenders and Top 1% net worth:
V4236_Male_ByQuarter <- incident_series |> 
  filter(V4236 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4236 = sum(V4236 == 1))

cor.test(as.numeric(V4236_Male_ByQuarter$AnnTotal_V4236) , Top1Net_Worth_1992_2021$...2)
```

---

What is the correlation between female offenders and Gini? Here, the value is -0.231, with a similar number as to net worth. The count of both male and female offenders, since 1992 in the aggregate, appear to be weakly correlated with the Gini coefficient, but again, there is the 2012 inflection point, which requires further analysis.
```{r}
#Correlation between V4236, females, and Gini
AggV4236_Female <- incident_series |> 
  filter(V4236 <= 4) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4236 = sum(V4236 == 2))

ShortV4236_Female <- filter(AggV4236_Female , Yearonly < 2021)

cor.test(ShortV4236_Female$AnnTotal_V4236, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between female offenders and Top 1% net worth:
V4236_Female_ByQuarter <- incident_series |> 
  filter(V4236 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4236 = sum(V4236 == 2))

cor.test(as.numeric(V4236_Female_ByQuarter$AnnTotal_V4236) , Top1Net_Worth_1992_2021$...2)
```

---

How old was the offender, if there was just one? This is very interesting: crime among people 20 and under has been falling. Crime among ages 21-29 has fallen, but less so and with more fluctuation. Crime among people 30+, as a percent of total incidents, has doubled from around 30% to around 60%.
```{r}
#Graphs, age of offenders, count and percent
incident_series |> filter(V4237 == 3) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the single offender 15-17 years old?") +
  geom_bar(aes(y = V4237), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> filter(V4237 == 4) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the single offender 18-20 years old?") +
  geom_bar(aes(y = V4237), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> filter(V4237 == 5) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the single offender 21-29 years old?") +
  geom_bar(aes(y = V4237), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> filter(V4237 == 6) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the single offender 30 years old or older?") +
  geom_bar(aes(y = V4237), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

incident_series |> 
  filter(V4237 <= 7) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4237 == 3) / sum(V4237 < 8)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("15-17 years old") +
  geom_line() +
  geom_smooth(method = "loess", color = "purple3") +
  xlab("Year") +
  ylab("Offenders age 15-17")

incident_series |> 
  filter(V4237 <= 7) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4237 == 4) / sum(V4237 < 8)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("18-20 years old") +
  geom_line() +
  geom_smooth(method = "loess", color = "purple3") +
  xlab("Year") +
  ylab("Offenders age 18-20")

incident_series |> 
  filter(V4237 <= 7) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4237 == 5) / sum(V4237 < 8)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("21-29 years old") +
  geom_line() +
  geom_smooth(method = "loess", color = "purple3") +
  xlab("Year") +
  ylab("Offenders age 21-29")

incident_series |> 
  filter(V4237 <= 7) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4237 == 6) / sum(V4237 < 8)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("30+ years old") +
  geom_line() +
  geom_smooth(method = "loess", color = "purple3") +
  xlab("Year") +
  ylab("Offenders age 30+")
```

---

What is the correlation between offenders 30+ and Gini? The correlation is negative, at -0.226. It's even lower as to net worth.
```{r}
#Correlation between 30 years + and Gini
AggV4237 <- incident_series |> 
  filter(V4237 <= 7) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4237 = sum(V4237 == 6))

ShortV4237 <- filter(AggV4237 , Yearonly < 2021)

cor.test(ShortV4237$AnnTotal_V4237, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between 30 years + and top 1% net worth 
V4237_ByQuarter <- incident_series |> 
  filter(V4237 <= 7) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4237 = sum(V4237 == 6))

cor.test(V4237_ByQuarter$AnnTotal_V4237 , Top1Net_Worth_1992_2021$...2)
```

---

Was the offender drinking and/or on drugs? Given the following data, it seems pretty clear that crimes committed while drinking fell gradually over time, and crimes committed while on drugs increased gradually over time.
```{r}
#graphs of drinking and drugs, count and percent
incident_series |> filter(V4240 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender drinking?") +
  geom_bar(aes(y = V4240), stat = "identity") +
  theme_fivethirtyeight() +
  theme(axis.title = element_text()) +
  xlab("Year") +
  ylab("Yes, drinking")

incident_series |> 
  filter(V4240 <= 5) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4240 == 1) / sum(V4240 < 5)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender drinking") +
  geom_line() +
  geom_smooth(method = "loess", color = "purple3") +
  xlab("Year") +
  ylab("Offender drinking")

incident_series |> filter(V4240 == 2) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender on drugs?") +
  geom_bar(aes(y = V4240), stat = "identity") +
  xlab("Year") +
  ylab("Yes, on drugs")

incident_series |> 
  filter(V4240 <= 5) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4240 == 2) / sum(V4240 < 5)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender on drugs") +
  geom_line() +
  geom_smooth(method = "loess", color = "purple3") +
  xlab("Year") +
  ylab("Offender on drugs")

incident_series |> filter(V4240 == 3) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender drinking and on drugs?") +
  geom_bar(aes(y = V4240), stat = "identity") +
  xlab("Year") +
  ylab("Yes, drinking and on drugs")

incident_series |> 
  filter(V4240 <= 5) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4240 == 3) / sum(V4240 < 5)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  geom_smooth(method = "loess") +
  xlab("Year") +
  ylab("Offender drinking and on drugs")

incident_series |> filter(V4240 == 4) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender drinking or on drugs but you couldn't tell which?") +
  geom_bar(aes(y = V4240), stat = "identity") +
  xlab("Year") +
  ylab("Yes, drinking or on drugs, could not tell which")

incident_series |> 
  filter(V4240 <= 5) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4240 == 4) / sum(V4240 < 5)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  geom_smooth(method = "loess") +
  xlab("Year") +
  ylab("Offender drinking or on drugs, couldn't tell which")
```

---

How about the correlation between drinking or on drugs and Gini and net worth? The correlation between drinking and Gini is moderately negative, at -0.406. The correlation between drugs and Gini is nearly zero, at -0.0321. And the correlation between drinking and drugs and Gini is -0.232. The numbers as to net worth are similar. This suggests that economic inequality is most strongly related to drinking: as economic inequality goes up, drinking during crime tends to go down. This may reflect the general belief that drug use is an increasingly prevalent problem--i.e. people are switching from drinking to drugs.
```{r}
#Correlation between drinking and Gini
AggV4240_drink <- incident_series |> 
  filter(V4240 <= 5) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4240 = sum(V4240 == 1))

ShortV4240_drink <- filter(AggV4240_drink , Yearonly < 2021)

cor.test(ShortV4240_drink$AnnTotal_V4240, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between drinking and top 1% net worth
V4240_drink_ByQuarter <- incident_series |> 
  filter(V4240 <= 5) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4240 = sum(V4240 == 1))

cor.test(V4240_drink_ByQuarter$AnnTotal_V4240 , Top1Net_Worth_1992_2021$...2)

#Correlation between drugs and Gini
AggV4240_drug <- incident_series |> 
  filter(V4240 <= 5) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4240 = sum(V4240 == 2))

ShortV4240_drug <- filter(AggV4240_drug , Yearonly < 2021)

cor.test(ShortV4240_drug$AnnTotal_V4240, as.numeric(Shortgini$SIPOVGINIUSA))

#Correlation between drugs and top 1% net worth
V4240_drug_ByQuarter <- incident_series |> 
  filter(V4240 <= 5) |> 
  group_by(YEARQ) |> 
  summarize(AnnTotal_V4240 = sum(V4240 == 2))

cor.test(V4240_drug_ByQuarter$AnnTotal_V4240 , Top1Net_Worth_1992_2021$...2)

#Correlation between drinking and drugs and Gini
AggV4240 <- incident_series |> 
  filter(V4240 <= 5) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4240 = sum(V4240 == 3))

ShortV4240 <- filter(AggV4240 , Yearonly < 2021)

cor.test(ShortV4240$AnnTotal_V4240, as.numeric(Shortgini$SIPOVGINIUSA))
```

---

Starting at V4241, the NCVS asks about any relationship between the offender and the respondent. I don't code for this right now, but may do so later.

---

As for single offenders and their race, the proportion of offenses committed by particular races is very stable over time. It is possible that the proportion of offenses committed by black offenders has fallen slightly over time, though not by much.
```{r}
#Graphs, race of offender, count and percent
incident_series |> filter(V4246B == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender white?") +
  geom_bar(aes(y = V4246B), stat = "identity") +
  xlab("Year") +
  ylab("Yes, white")

incident_series |> 
  filter(V4246B <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4246B == 1) / sum(V4246B < 2)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("White offender")

incident_series |> filter(V4246C == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender black?") +
  geom_bar(aes(y = V4246C), stat = "identity") +
  xlab("Year") +
  ylab("Yes, black")

incident_series |> 
  filter(V4246C <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4246C == 1) / sum(V4246C < 2)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("Black offender")

incident_series |> filter(V4246D == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender American Indian or Alaskan native?") +
  geom_bar(aes(y = V4246D), stat = "identity") +
  xlab("Year") +
  ylab("Yes, American Indian or Alaskan native")

incident_series |> 
  filter(V4246D <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4246D == 1) / sum(V4246D < 2)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("American Indian or Alaskan native offender")

incident_series |> filter(V4246E == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Was the offender Asian?") +
  geom_bar(aes(y = V4246E), stat = "identity") +
  xlab("Year") +
  ylab("Yes, Asian")

incident_series |> 
  filter(V4246E <= 2) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V4246E == 1) / sum(V4246E < 2)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line() +
  xlab("Year") +
  ylab("Asian offender")
```

---

What about any correlation between the race of the offender and Gini? The correlation for all races is positive: whites at 0.333, blacks at 0.352, Native Americans and Alaskan natives at 0.357, and Asians at 0.210. To be clear, this doesn't mean that every race is committing more crime. It means that when members of particular races do commit crime, they weakly positively track Gini. If these correlations mean anything (which is unclear at this point), they mean that Asians are least affected by economic inequality when it comes to committing crime, whites are most affected, but still weakly, and blacks and Native Americans and Alaskan natives are marginally more affected by economic inequality that whites.
```{r}
#Correlation between white offender and Gini
AggV4246B <- incident_series |> 
  filter(V4246B <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4246B = sum(V4246B == 1))

ShortV4246B <- filter(AggV4246B , Yearonly < 2021)

ShortTop1 <- filter(Top1Net_Worth_1992_2021 )

ShortginiV4246B <- filter(gini , year > 2011)

cor.test(ShortV4246B$AnnTotal_V4246B, as.numeric(ShortginiV4246B$SIPOVGINIUSA))

#Correlation between black offender and Gini
AggV4246C <- incident_series |> 
  filter(V4246C <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4246C = sum(V4246C == 1))

ShortV4246C <- filter(AggV4246C , Yearonly < 2021)

ShortginiV4246C <- filter(gini , year > 2011)

cor.test(ShortV4246C$AnnTotal_V4246C, as.numeric(ShortginiV4246C$SIPOVGINIUSA))

#Correlation between Native American or Alaskan native offender and Gini
AggV4246D <- incident_series |> 
  filter(V4246D <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4246D = sum(V4246D == 1))

ShortV4246D <- filter(AggV4246D , Yearonly < 2021)

ShortginiV4246D <- filter(gini , year > 2011)

cor.test(ShortV4246D$AnnTotal_V4246D, as.numeric(ShortginiV4246D$SIPOVGINIUSA))

#Correlation between Asian offender and Gini
AggV4246E <- incident_series |> 
  filter(V4246E <= 2) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4246E = sum(V4246E == 1))

ShortV4246E <- filter(AggV4246E , Yearonly < 2021)

ShortginiV4246E <- filter(gini , year > 2011)

cor.test(ShortV4246E$AnnTotal_V4246E, as.numeric(ShortginiV4246E$SIPOVGINIUSA))
```

#Combining NCVS variables

The above data analysis can be viewed as a first attempt at determining the relationship, if any, between economic inequality and American crime rates. The early conclusion is that there appears to be little or no association, and where there is an association, it is *negative*, that is, as economic inequality increases, the crime rate goes down. This is intuitively incorrect: either the crime rate should be completely unrelated to economic inequality, or one would think that crime rates (at least some crime rates, like thefts) should go up. In response to this, we can note that most p-values suggest that any supposed association isn't statistically significant.

We do glean some interesting hypotheses from the above data, which require further research outside the scope of this article. For now, however, let's continue our exploration of any possible association between economic inequality and crime rates. Let's do so by combining certain variables in the NCVS and determining the association of those variables with economic inequality.

We cannot, of course, take all variable combinations, so let's choose some that seem intuitively like they should, or could, be related to economic inequality.

In this section, we begin to combine multiple variables to gain insight into the data and start to explore whether economic inequality is associated with crime rates in ways that are not apparent given single NCVS variables:

---

Let's start by exploring the income level of household that were subjects in the NCVS. Here, we combine the NCVS variable on household income and the variable that asks whether an incident involved forcible entry:

```{r}
#Code for income level of households and incidents involving forcible entry
V2026_subset <- household_series |>
  select(IDHH , Yearonly , V2026)

V4028_subset <- incident_series |>
  select(IDHH, Yearonly, V4028)

#Now, let's take both of these, and combine them into a new dataframe with both variables in it. We're using "inner join" which will combine only the data in each dataframe that matches given IDHH:
V2026_V4028_combined <- 
  inner_join(V4028_subset , V2026_subset , join_by(IDHH , Yearonly))

#Graph, combination of household income and incidents involving forcible entry
V2026_V4028_combined |>
  group_by(Yearonly , V2026) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2026) , color = as.factor(V2026))) +
  geom_line()
```

---

The above graph shows data for 18 different income groups plus the residue and out of universe data. Let's try to clarify things by grouping income groups into four larger groups. Of note: when a household's wealth hits `$`75,000, the rate of forcible entry appears to go down. In addition, forcible entries in households with incomes `$`150,000 - `$`199,999 appear to have plummeted from 32.5% to under 20%.
```{r}
#Evidence of forcible entry in households of incomes $0 - $14,999:
V2026_V4028_combined |>
  filter(V2026 < 06) |>
  group_by(Yearonly , V2026) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2026) , color = as.factor(V2026))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households of incomes $15,000 - $29,999:
V2026_V4028_combined |>
  filter(V2026 > 05, V2026 < 10) |>
  group_by(Yearonly , V2026) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2026) , color = as.factor(V2026))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households of incomes $30,000 - $74,999:
V2026_V4028_combined |>
  filter(V2026 > 09, V2026 < 15) |>
  group_by(Yearonly , V2026) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2026) , color = as.factor(V2026))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households of incomes $75,000 - $99,999:
V2026_V4028_combined |>
  filter(V2026 > 13, V2026 < 16) |>
  group_by(Yearonly , V2026) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2026) , color = as.factor(V2026))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households of incomes $100,000 - $199,999:
V2026_V4028_combined |>
  filter(V2026 > 15, V2026 < 18) |>
  group_by(Yearonly , V2026) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2026) , color = as.factor(V2026))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households of incomes $200,000 or higher:
V2026_V4028_combined |>
  filter(V2026 == 18) |>
  group_by(Yearonly , V2026) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2026) , color = as.factor(V2026))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

How about combining respondents' educational levels with evidence of forcible entry?
```{r}
#Code on respondents' educational levels and evidence of forcible entry
V3020_subset <- person_series |>
  select(IDHH , Yearonly , V3020)

V4028_subset <- incident_series |>
  select(IDHH, Yearonly, V4028)

#Now, let's take both of these, and combine them into a new dataframe with both variables in it. We're using "inner join" which will combine only the data in each dataframe that matches given IDHH:
V3020_V4028_combined <- 
  inner_join(V4028_subset , V3020_subset , join_by(IDHH , Yearonly))

#Graph, respondents' educational levels and evidence of forcible entry
V3020_V4028_combined |>
  group_by(Yearonly , V3020) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V3020) , color = as.factor(V3020))) +
  geom_line()
```

```{r}
#Create a visual and data, showing educational attainment in each year of the time series. V3020_subset has over 7 million entries. Column "Yearonly" is the year, from 1992 to 2021. COlumn "V3020" is the digit code, indicating the level of education reached. Each row is one observation, so if there were, say, 23 respondents who held a doctoral degree in 1998, there would be 23 rows/observations where Yearonly = 1998 and V3020 = 45. 

#I need to first filter out all V3020 values over 45; that will get rid of the residue and the out of universe observations.

EducAttain <- V3020_subset |>
  filter(V3020 < 50)

#I then need to sum, by year, all of the like V3020 values, which would give me a count of the observations, by year, by level of educational attainment.

EducAttain_00 <- EducAttain |>
  filter(V3020 == 00)
EducAttain_01 <- EducAttain |>
  filter(V3020 == 01)
EducAttain_02 <- EducAttain |>
  filter(V3020 == 02)
EducAttain_03 <- EducAttain |>
  filter(V3020 == 03)
EducAttain_04 <- EducAttain |>
  filter(V3020 == 04)
EducAttain_05 <- EducAttain |>
  filter(V3020 == 05)
EducAttain_06 <- EducAttain |>
  filter(V3020 == 06)
EducAttain_07 <- EducAttain |>
  filter(V3020 == 07)
EducAttain_08 <- EducAttain |>
  filter(V3020 == 08)
EducAttain_09 <- EducAttain |>
  filter(V3020 == 09)
EducAttain_10 <- EducAttain |>
  filter(V3020 == 10)
EducAttain_11 <- EducAttain |>
  filter(V3020 == 11)
EducAttain_12 <- EducAttain |>
  filter(V3020 == 12)
EducAttain_21 <- EducAttain |>
  filter(V3020 == 21)
EducAttain_22 <- EducAttain |>
  filter(V3020 == 22)
EducAttain_23 <- EducAttain |>
  filter(V3020 == 23)
EducAttain_24 <- EducAttain |>
  filter(V3020 == 24)
EducAttain_25 <- EducAttain |>
  filter(V3020 == 25)
EducAttain_26 <- EducAttain |>
  filter(V3020 == 26)
EducAttain_27 <- EducAttain |>
  filter(V3020 == 27)
EducAttain_28 <- EducAttain |>
  filter(V3020 == 28)
EducAttain_40 <- EducAttain |>
  filter(V3020 == 40)
EducAttain_41 <- EducAttain |>
  filter(V3020 == 41)
EducAttain_42 <- EducAttain |>
  filter(V3020 == 42)
EducAttain_43 <- EducAttain |>
  filter(V3020 == 43)
EducAttain_44 <- EducAttain |>
  filter(V3020 == 44)
EducAttain_45 <- EducAttain |>
  filter(V3020 == 45)

#I then need to place these sums into a visualizable form.

ggplot(EducAttain_00, aes(x = Yearonly)) +
  geom_bar()

ggplot(EducAttain_01, aes(x = Yearonly)) +
  geom_bar()

ggplot(EducAttain_02, aes(x = Yearonly)) +
  geom_bar()
EducAttain_02 |> count(Yearonly)

ggplot(EducAttain_28, aes(x = Yearonly)) +
  geom_bar()
EducAttain_28 |> count(Yearonly)

ggplot(EducAttain_42, aes(x = Yearonly)) +
  geom_bar()
EducAttain_42 |> count(Yearonly)

ggplot(EducAttain_43, aes(x = Yearonly)) +
  geom_bar()
EducAttain_43 |> count(Yearonly)

ggplot(EducAttain_44, aes(x = Yearonly)) +
  geom_bar()
EducAttain_44 |> count(Yearonly)

ggplot(EducAttain_45, aes(x = Yearonly)) +
  geom_bar()
EducAttain_45 |> count(Yearonly)

EducAttain_00_count <- EducAttain_00 |> count(Yearonly)
EducAttain_01_count <- EducAttain_01 |> count(Yearonly)
EducAttain_02_count <- EducAttain_02 |> count(Yearonly)
EducAttain_03_count <- EducAttain_03 |> count(Yearonly)
EducAttain_04_count <- EducAttain_04 |> count(Yearonly)
EducAttain_05_count <- EducAttain_05 |> count(Yearonly)
EducAttain_06_count <- EducAttain_06 |> count(Yearonly)
EducAttain_07_count <- EducAttain_07 |> count(Yearonly)
EducAttain_08_count <- EducAttain_08 |> count(Yearonly)
EducAttain_09_count <- EducAttain_09 |> count(Yearonly)
EducAttain_10_count <- EducAttain_10 |> count(Yearonly)
EducAttain_11_count <- EducAttain_11 |> count(Yearonly)
EducAttain_12_count <- EducAttain_12 |> count(Yearonly)
EducAttain_21_count <- EducAttain_21 |> count(Yearonly)
EducAttain_22_count <- EducAttain_22 |> count(Yearonly)
EducAttain_23_count <- EducAttain_23 |> count(Yearonly)
EducAttain_24_count <- EducAttain_24 |> count(Yearonly)
EducAttain_25_count <- EducAttain_25 |> count(Yearonly)
EducAttain_26_count <- EducAttain_26 |> count(Yearonly)
EducAttain_27_count <- EducAttain_27 |> count(Yearonly)
EducAttain_28_count <- EducAttain_28 |> count(Yearonly)
EducAttain_40_count <- EducAttain_40 |> count(Yearonly)
EducAttain_41_count <- EducAttain_41 |> count(Yearonly)
EducAttain_42_count <- EducAttain_42 |> count(Yearonly)
EducAttain_43_count <- EducAttain_43 |> count(Yearonly)
EducAttain_44_count <- EducAttain_44 |> count(Yearonly)
EducAttain_45_count <- EducAttain_45 |> count(Yearonly)

length(EducAttain_45_count) <- length(EducAttain_00_count)
length(EducAttain_44_count) <- length(EducAttain_00_count)
length(EducAttain_43_count) <- length(EducAttain_00_count)
length(EducAttain_42_count) <- length(EducAttain_00_count)
length(EducAttain_41_count) <- length(EducAttain_00_count)
length(EducAttain_40_count) <- length(EducAttain_00_count)
length(EducAttain_28_count) <- length(EducAttain_00_count)
length(EducAttain_27_count) <- length(EducAttain_00_count)
length(EducAttain_26_count) <- length(EducAttain_00_count)
length(EducAttain_25_count) <- length(EducAttain_00_count)
length(EducAttain_24_count) <- length(EducAttain_00_count)
length(EducAttain_23_count) <- length(EducAttain_00_count)
length(EducAttain_22_count) <- length(EducAttain_00_count)
length(EducAttain_21_count) <- length(EducAttain_00_count)
length(EducAttain_12_count) <- length(EducAttain_00_count)
length(EducAttain_11_count) <- length(EducAttain_00_count)
length(EducAttain_10_count) <- length(EducAttain_00_count)
length(EducAttain_09_count) <- length(EducAttain_00_count)
length(EducAttain_08_count) <- length(EducAttain_00_count)
length(EducAttain_07_count) <- length(EducAttain_00_count)
length(EducAttain_06_count) <- length(EducAttain_00_count)
length(EducAttain_05_count) <- length(EducAttain_00_count)
length(EducAttain_04_count) <- length(EducAttain_00_count)
length(EducAttain_03_count) <- length(EducAttain_00_count)
length(EducAttain_02_count) <- length(EducAttain_00_count)
length(EducAttain_01_count) <- length(EducAttain_00_count)

#Determining percentage of respondents with elementary or less education

EducAttain_master <- data.frame(Year = c(1992:2021),
                                Count_00 = c(EducAttain_00_count),
                                Count_01 = c(EducAttain_01_count),
                                Count_02 = c(EducAttain_02_count),
                                Count_03 = c(EducAttain_03_count),
                                Count_04 = c(EducAttain_04_count),
                                Count_05 = c(EducAttain_05_count),
                                Count_06 = c(EducAttain_06_count),
                                Count_07 = c(EducAttain_07_count),
                                Count_08 = c(EducAttain_08_count),
                                Count_09 = c(EducAttain_09_count),
                                Count_10 = c(EducAttain_10_count),
                                Count_11 = c(EducAttain_11_count))

EducAttain_master$Count_00.Yearonly <- NULL
EducAttain_master$Count_01.Yearonly <- NULL
EducAttain_master$Count_02.Yearonly <- NULL
EducAttain_master$Count_03.Yearonly <- NULL
EducAttain_master$Count_04.Yearonly <- NULL
EducAttain_master$Count_05.Yearonly <- NULL
EducAttain_master$Count_06.Yearonly <- NULL
EducAttain_master$Count_07.Yearonly <- NULL
EducAttain_master$Count_08.Yearonly <- NULL
EducAttain_master$Count_09.Yearonly <- NULL
EducAttain_master$Count_10.Yearonly <- NULL
EducAttain_master$Count_11.Yearonly <- NULL

EducAttain_master_noYear_elementary <- data.frame(Count_00 = c(EducAttain_00_count),
                                Count_01 = c(EducAttain_01_count),
                                Count_02 = c(EducAttain_02_count),
                                Count_03 = c(EducAttain_03_count),
                                Count_04 = c(EducAttain_04_count),
                                Count_05 = c(EducAttain_05_count),
                                Count_06 = c(EducAttain_06_count),
                                Count_07 = c(EducAttain_07_count),
                                Count_08 = c(EducAttain_08_count))

EducAttain_master_noYear_elementary$Count_00.Yearonly <- NULL
EducAttain_master_noYear_elementary$Count_01.Yearonly <- NULL
EducAttain_master_noYear_elementary$Count_02.Yearonly <- NULL
EducAttain_master_noYear_elementary$Count_03.Yearonly <- NULL
EducAttain_master_noYear_elementary$Count_04.Yearonly <- NULL
EducAttain_master_noYear_elementary$Count_05.Yearonly <- NULL
EducAttain_master_noYear_elementary$Count_06.Yearonly <- NULL
EducAttain_master_noYear_elementary$Count_07.Yearonly <- NULL
EducAttain_master_noYear_elementary$Count_08.Yearonly <- NULL

Elementary_count <- rowSums(EducAttain_master_noYear_elementary)

Elementary_count_withYear <- data.frame(Year = c(1992:2021),
                                        Elementary_count)

##HERE IS HOW WE PROCESS DATA IN v3020:

#Here, we produce the total count of all responses re educational attainment by year, except residue and out of universe
V3020_total_count <- V3020_subset |>
  filter(V3020 < 50) |>
  group_by(Yearonly, V3020) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_count = sum(n))

#Here, we find the count of all responses 00-08, elementary and under
Elementary_total_count <- V3020_subset |>
  filter(V3020 < 09) |>
  group_by(Yearonly, V3020) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_Elementary_count = sum(n))

#Now, get the percentage of all responses 00-08 out of total responses
Elementary_and_total <- merge(V3020_total_count , Elementary_total_count)

Elementary_and_total |>
  ggplot(aes(x = Yearonly, y = total_Elementary_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Elementary education or less") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")

#REPEAT THE PROCESS FOR THESE TWO DATASETS, AS ABOVE:

EducAttain_master2 <- data.frame(Year = c(1992:2002),
                                Count_12 = c(EducAttain_12_count),
                                Count_21 = c(EducAttain_21_count),
                                Count_22 = c(EducAttain_22_count),
                                Count_23 = c(EducAttain_23_count),
                                Count_24 = c(EducAttain_24_count),
                                Count_25 = c(EducAttain_25_count),
                                Count_26 = c(EducAttain_26_count))

EducAttain_master3 <- data.frame(Year = c(2003:2021),
                                Count_27 = c(EducAttain_27_count),                                                                             Count_28 = c(EducAttain_28_count),
                                Count_40 = c(EducAttain_40_count),                                                                             Count_41 = c(EducAttain_41_count),
                                Count_42 = c(EducAttain_42_count),                                                                             Count_43 = c(EducAttain_43_count),
                                Count_44 = c(EducAttain_44_count),                                                                             Count_45 = c(EducAttain_45_count))

EducAttain_master2$Count_12.Yearonly <- NULL
EducAttain_master2$Count_21.Yearonly <- NULL
EducAttain_master2$Count_22.Yearonly <- NULL
EducAttain_master2$Count_23.Yearonly <- NULL
EducAttain_master2$Count_24.Yearonly <- NULL
EducAttain_master2$Count_25.Yearonly <- NULL
EducAttain_master2$Count_26.Yearonly <- NULL

EducAttain_master3$Count_27.Yearonly <- NULL
EducAttain_master3$Count_28.Yearonly <- NULL
EducAttain_master3$Count_40.Yearonly <- NULL
EducAttain_master3$Count_41.Yearonly <- NULL
EducAttain_master3$Count_42.Yearonly <- NULL
EducAttain_master3$Count_43.Yearonly <- NULL
EducAttain_master3$Count_44.Yearonly <- NULL
EducAttain_master3$Count_45.Yearonly <- NULL

#Here, we find the count of all responses 09-12, 27, high school education no diploma
HSNoDip_total_count <- V3020_subset |>
  filter(V3020 == 09 | V3020 == 10 | V3020 == 11 | V3020 == 12 | V3020 == 27) |>
  group_by(Yearonly, V3020) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_HSNoDip_count = sum(n))

#Now, get the percentage of all responses 09-12, 27 out of total responses
HSNoDip_and_total <- merge(V3020_total_count , HSNoDip_total_count)

HSNoDip_and_total |>
  ggplot(aes(x = Yearonly, y = total_HSNoDip_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Some high school education, no diploma") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")

#Here, we find the count of all responses 21-26, 40, some college, no diploma
CollegeNoDip_total_count <- V3020_subset |>
  filter(V3020 == 21 | V3020 == 22 | V3020 == 23 | V3020 == 24 | V3020 == 25 | V3020 == 26 | V3020 == 40) |>
  group_by(Yearonly, V3020) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_CollegeNoDip_count = sum(n))

#Now, get the percentage of all responses 21-26, 40, some college, no diploma
CollegeNoDip_and_total <- merge(V3020_total_count , CollegeNoDip_total_count)

CollegeNoDip_and_total |>
  ggplot(aes(x = Yearonly, y = total_CollegeNoDip_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Some college education, no diploma") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")

#Here, we find the count of all responses 28, 41, 42, high school, associates, or bachelor's degree
Dip_total_count <- V3020_subset |>
  filter(V3020 == 28 | V3020 == 41 | V3020 == 42) |>
  group_by(Yearonly, V3020) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_Dip_count = sum(n))

#Now, get the percentage of all responses 28, 41, 42, high school, associates, or bachelor's degree
Dip_and_total <- merge(V3020_total_count , Dip_total_count)

Dip_and_total |>
  ggplot(aes(x = Yearonly, y = total_Dip_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("HS, Asso, or college degree") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")

#Here, we find the count of all responses 43, 44, 45, master, prof school, or doctorate degree
GradDip_total_count <- V3020_subset |>
  filter(V3020 == 43 | V3020 == 44 | V3020 == 45) |>
  group_by(Yearonly, V3020) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_GradDip_count = sum(n))

#Now, get the percentage of all responses 43, 44, 45, master, prof school, or doctorate degree
GradDip_and_total <- merge(V3020_total_count , GradDip_total_count)

GradDip_and_total |>
  ggplot(aes(x = Yearonly, y = total_GradDip_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Master's, prof school, or doctorate degree") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")

```


---

This is a jumble. Let's try to clarify it by grouping educational attainment levels together. As we can see, there doesn't appear to be a clear advantage to higher education when it comes to avoiding incidents of forcible entry: each educational level tends to have the same rate, although it does fluctuate a great deal.
```{r}
#Evidence of forcible entry in households with lower than high school education as the highest level of education received:
V3020_V4028_combined |>
  filter(V3020 < 09) |>
  group_by(Yearonly , V3020) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V3020) , color = as.factor(V3020))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households with high school education as the highest level of education received:
V3020_V4028_combined |>
  filter(V3020 > 08, V3020 < 21) |>
  group_by(Yearonly , V3020) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V3020) , color = as.factor(V3020))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households with college education as the highest level of education received:
V3020_V4028_combined |>
  filter(V3020 > 20, V3020 < 27) |>
  group_by(Yearonly , V3020) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V3020) , color = as.factor(V3020))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households with a bachelor's degree as the highest level of education received:
V3020_V4028_combined |>
  filter(V3020 == 42) |>
  group_by(Yearonly , V3020) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V3020) , color = as.factor(V3020))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households with a master's degree as the highest level of education received:
V3020_V4028_combined |>
  filter(V3020 == 43) |>
  group_by(Yearonly , V3020) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V3020) , color = as.factor(V3020))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households with a professional school degree as the highest level of education received:
V3020_V4028_combined |>
  filter(V3020 == 44) |>
  group_by(Yearonly , V3020) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V3020) , color = as.factor(V3020))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Evidence of forcible entry in households with a doctoral degree as the highest level of education received:
V3020_V4028_combined |>
  filter(V3020 == 45) |>
  group_by(Yearonly , V3020) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V3020) , color = as.factor(V3020))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

How about comparing the number of units in the household's housing structure with incidence of forcible entries?
```{r}
#Code on household's housing structure and incidence of forcible entries
V2024_subset <- household_series |>
  select(IDHH , Yearonly , V2024)

V4028_subset <- incident_series |>
  select(IDHH, Yearonly, V4028)

#Now, let's take both of these, and combine them into a new dataframe with both variables in it. We're using "inner join" which will combine only the data in each dataframe that matches given IDHH:
V2024_V4028_combined <- 
  inner_join(V4028_subset , V2024_subset , join_by(IDHH , Yearonly))

#Graph, household's housing structure and incidence of forcible entries
V2024_V4028_combined |>
  group_by(Yearonly , V2024) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2024) , color = as.factor(V2024))) +
  geom_line()
```

---

Again, this appears as a jumble, so let's group some results together:
```{r}
#Incidence of forcible entries into households within a structure with one residential unit (i.e. a stand-alone house):
V2024_V4028_combined |>
  filter(V2024 == 01) |>
  group_by(Yearonly , V2024) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2024) , color = as.factor(V2024))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Incidence of forcible entries into households within a structure with 2 - 4 residential units:
V2024_V4028_combined |>
  filter(V2024 > 01, V2024 < 05) |>
  group_by(Yearonly , V2024) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2024) , color = as.factor(V2024))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Incidence of forcible entries into households within a structure with 5 - 9 residential units:
V2024_V4028_combined |>
  filter(V2024 == 05) |>
  group_by(Yearonly , V2024) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2024) , color = as.factor(V2024))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Incidence of forcible entries into households within a structure with 10 or more residential units:
V2024_V4028_combined |>
  filter(V2024 == 06) |>
  group_by(Yearonly , V2024) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2024) , color = as.factor(V2024))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()

#Incidence of forcible entries into households within a structure that is a mobile home or trailer:
V2024_V4028_combined |>
  filter(V2024 == 07) |>
  group_by(Yearonly , V2024) |>
  summarize(Percent = sum(V4028 == 1) / sum(V4028 < 3)) |>
  ggplot(aes(x = Yearonly, y = Percent , group = as.factor(V2024) , color = as.factor(V2024))) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  geom_line()
```

---

As can be seen, there is no obvious benefit in terms of incidence of forcible entry to living in a structure with any particular number of housing units. To note, however: except for mobile homes/trailers, all residences in whatever size housing structure saw a noticeable drop in the incidence of forcible entry leading up to 2020.

---

Now, what about the correlation between the Gini coefficient and residences with particular numbers of housing units that experienced forcible entries?
```{r}
#Correlation between V2024 and 4028 and Gini
AggV2024_V4028_combined <- incident_series |> 
  filter(V4023B <= 3) |> 
  group_by(Yearonly) |> 
  summarize(AnnTotal_V4023B = sum(V4023B == 1)) 

ShortV4023B <- filter(AggV4023B , Yearonly < 2021)

ShortginiV4023B <- filter(gini , year > 1998)

cor.test(ShortV4023B$AnnTotal_V4023B , as.numeric(ShortginiV4023B$SIPOVGINIUSA))

#Correlation between Gini and forcible entries of homes with one unit (i.e. stand-alone houses)
ShortV2024_V4028_combined <- filter(V2024_V4028_combined , Yearonly < 2021)
```

```{r}
#Graphs of V3071
person_series |> filter(V3071 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Did you have a job or work at a business last week?") +
  geom_bar(aes(y = V3071), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

person_series |> 
  filter(V3071 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3071 == 1) / sum(V3071 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Have a job/work at a business last week?") +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_line() +
  geom_smooth(method = "loess")
```

```{r}
#Graphs of V3072
person_series |> filter(V3072 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Have a job/work in the last 6 months?") +
  geom_bar(aes(y = V3072), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

person_series |> 
  filter(V3072 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3072 == 1) / sum(V3072 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Have a job/work in the last 6 months?") +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_line() +
  geom_smooth(method = "loess")
```


```{r}
#Graphs of V3073
person_series |> filter(V3073 == 1) |> ggplot(aes(x = YEARQ)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Did the job in the last 6 months last 2 consecutive weeks or more?") +
  geom_bar(aes(y = V3073), stat = "identity") +
  xlab("Year") +
  ylab("Yes")

person_series |> 
  filter(V3073 <= 4) |> 
  group_by(YEARQ) |> 
  summarize(Percent = sum(V3073 == 1) / sum(V3073 < 4)) |>
  ggplot(aes(x = YEARQ, y = Percent)) +
      theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Did job last 2 or more consecutive weeks?") +
  xlab("Year") +
  ylab("Yes responses, percent") +
  geom_line() +
  geom_smooth(method = "loess")
```

```{r}
V3074_subset <- person_series |>
  filter(V3074 < 30)

#Here, we produce the total count of all responses re job type by year, except residue and out of universe
V3074_total_count <- V3074_subset |>
  filter(V3074 < 30) |>
  group_by(Yearonly, V3074) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_count = sum(n))

#Here, we find the count of all responses 01-03, medical, and percentage of total
Medical_total_count <- V3074_subset |>
  filter(V3074 < 04) |>
  group_by(Yearonly, V3074) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_Medical_count = sum(n))

Medical_and_total <- merge(V3074_total_count , Medical_total_count)

Medical_and_total |>
  ggplot(aes(x = Yearonly, y = total_Medical_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Medical field") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")

#Here, we find the count of all responses 05-06, professional, and percentage of total
Prof_total_count <- V3074_subset |>
  filter(V3074 == 05 | V3074 == 06) |>
  group_by(Yearonly, V3074) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_Prof_count = sum(n))

Prof_and_total <- merge(V3074_total_count , Prof_total_count)

Prof_and_total |>
  ggplot(aes(x = Yearonly, y = total_Prof_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Professional field") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")

#Here, we find the count of all responses 08-14, education, and percentage of total
Educationfield_total_count <- V3074_subset |>
  filter(V3074 == 08 | V3074 == 09 | V3074 == 10 | V3074 == 11 | V3074 == 12 | V3074 == 13 | V3074 == 14) |>
  group_by(Yearonly, V3074) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_Educationfield_count = sum(n))

Educationfield_and_total <- merge(V3074_total_count , Educationfield_total_count)

Educationfield_and_total |>
  ggplot(aes(x = Yearonly, y = total_Educationfield_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Educational field") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")

#Here, we find the count of all responses 16-18, law enforcement, and percentage of total
LEO_total_count <- V3074_subset |>
  filter(V3074 == 16 | V3074 == 17 | V3074 == 18) |>
  group_by(Yearonly, V3074) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_LEO_count = sum(n))

LEO_and_total <- merge(V3074_total_count , LEO_total_count)

LEO_and_total |>
  ggplot(aes(x = Yearonly, y = total_LEO_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Law enforcement field") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")

#Here, we find the count of all responses 20-22, convenience service, and percentage of total
Convenience_total_count <- V3074_subset |>
  filter(V3074 == 20 | V3074 == 21 | V3074 == 22) |>
  group_by(Yearonly, V3074) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_Convenience_count = sum(n))

Convenience_and_total <- merge(V3074_total_count , Convenience_total_count)

Convenience_and_total |>
  ggplot(aes(x = Yearonly, y = total_Convenience_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Convenience field") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")

#Here, we find the count of all responses 24-25, bus/taxi, and percentage of total
Driving_total_count <- V3074_subset |>
  filter(V3074 == 24 | V3074 == 25) |>
  group_by(Yearonly, V3074) |>
  tally() |>
  group_by(Yearonly) |>
  summarize(total_Driving_count = sum(n))

Driving_and_total <- merge(V3074_total_count , Driving_total_count)

Driving_and_total |>
  ggplot(aes(x = Yearonly, y = total_Driving_count / total_count)) +
        theme_fivethirtyeight() +
    theme(axis.title = element_text()) +
  ggtitle("Bus or taxi driver") +
  xlab("Year") +
  ylab("Percent") +
  geom_line() +
  geom_smooth(method = "loess")
```

---

## Conclusion

Let's return to the original question: is economic inequality in the United States associated with crime rates? Apparently, the answer to that is clearly no. To be sure, the analysis presented in this article has its limitations. First, it presents aggregeted data, rather than disaggregated data. Second, it does not include logistic regression, which could detect an association when multiple variables are combined. By these two limitations, this study is unable to determine the potential presence of a Simpson paradox, and it may therefore not reveal that economic inequality is in fact associated with crime rates.

And yet those limitations are also a sort of benefit, as previous research on the connection between economic inequality and crimes rates has uniformly focused in disaggregated data. Furthermore, this past research has limited itself to brief periods of time and limited types of crime. The research presented in this study covers the longest time frame of any study of its sort, and it has tested any potential association against multiple types of crime and data suggestive of crime. This study is, therefore, a unique contribution to the literature.

This study makes one broad, conservative conclusion: that if there is an association between economic inequality and crime rates, the association isn't obvious. It also points the way to future scholarship in that it has revealed potential other dynamics in U.S. crime rates: that sex, age, and substance abuse are highly relevant to crime rates; that male substance abusers over 30 years of age are particularly susceptible to committing crime; and that there are two potential structural breaks in the time frame, at 2000-2002 and 2010-2012.

In order to continue to test for any association, the next step in research is to unearth potential confounding variables and perform logistic regression using them. In that way, we will be able increasingly to understand the forces that drive criminal conduct.